function requestSWInfo(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;o.open(t,e,!0),o.send(),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){var e=o.responseText,t=JSON.parse(e);n(t)}else r(o.status)}})}function errorHandler(e){console.log("failed with status",status)}function reflect(e){return e.then(function(e){return{resolved:e,status:"resolved"}},function(e){return{rejected:e,status:"rejected"}})}function getPlanetData(){function e(e){for(var r=1;r<=e;r++)currentPlanetURL=u+r,d.push(requestSWInfo(currentPlanetURL,"GET"));Promise.all(d.map(reflect)).then(function(e){t(e),n(),o()})}function t(e){var t=1;e.forEach(function(e){if(e.resolved){var n={id:t,name:e.resolved.name,terrain:e.resolved.terrain,population:e.resolved.population,diameter:e.resolved.diameter};e.resolved.residents.length?n.residents=e.resolved.residents.map(function(e){return e.replace(/[^0-9]/g,"")}):n.residents="unknown",planetDataLocal.push(n)}t++})}function n(){peopleDataLocal.forEach(function(e,t){a[t].innerHTML=r(e.planet)})}function r(e){var t="";return planetDataLocal.forEach(function(n){n.id!==parseInt(e)||(t=n.name)}),t}function o(){c.classList.add("load-screen--fadeout"),i.classList.add("load-screen__img--moveout"),setTimeout(function(){l.classList.add("main--show")},1e3),setTimeout(function(){s.forEach(function(e){e.classList.add("people-list__item-wrapper--show-items")})},1200)}var a=document.querySelectorAll(".people-list__planet"),s=document.querySelectorAll(".people-list__item-wrapper"),l=document.querySelector(".main"),c=document.querySelector(".load-screen"),i=document.querySelector(".load-screen__img"),u="https://swapi.co/api/planets/",d=[];requestSWInfo(u,"GET").then(function(t){e(t.count)},errorHandler)}var peopleDataLocal=[],planetDataLocal=[],renderList=function(){function e(e){for(var t=1;t<e;t+=2){var n=s.cloneNode(!0);a.appendChild(n)}o=document.querySelectorAll(".people-list__name")}function t(e){for(var t=1;t<=e;t++)currentPersonURL=l+t,c.push(requestSWInfo(currentPersonURL,"GET"));Promise.all(c.map(reflect)).then(function(e){n(e),r(),getPlanetData()})}function n(e){var t=1;e.forEach(function(e){if(e.resolved){var n={id:t,name:e.resolved.name,height:e.resolved.height,weight:e.resolved.mass,birth_year:e.resolved.birth_year,gender:e.resolved.gender};e.resolved.homeworld?n.planet=e.resolved.homeworld.replace(/[^0-9]/g,""):n.planet="unknown",e.resolved.species[0]?n.species=e.resolved.species[0].replace(/[^0-9]/g,""):n.species="unknown",peopleDataLocal.push(n)}t++})}function r(){peopleDataLocal.forEach(function(e,t){o[t].innerHTML=e.name})}var o,a=document.querySelector(".people-list__grid"),s=document.querySelector(".people-list__item"),l="https://swapi.co/api/people/",c=[];requestSWInfo(l,"GET").then(function(n){var r=n.count;e(r),t(r)},errorHandler)}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJwbGFuZXQtbGlzdC5qcyIsInBlb3BsZS1saXN0LmpzIl0sIm5hbWVzIjpbInJlcXVlc3RTV0luZm8iLCJ1cmwiLCJtZXRob2RUeXBlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJzZW5kIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsInJlc3AiLCJyZXNwb25zZVRleHQiLCJyZXNwSnNvbiIsIkpTT04iLCJwYXJzZSIsImVycm9ySGFuZGxlciIsInN0YXR1c0NvZGUiLCJjb25zb2xlIiwibG9nIiwicmVmbGVjdCIsInByb21pc2UiLCJ0aGVuIiwicmVzb2x2ZWQiLCJyZWplY3RlZCIsImdldFBsYW5ldERhdGEiLCJfcG9wdWxhdGVMaXN0IiwicGxhbmV0TnVtYmVyIiwiaSIsImN1cnJlbnRQbGFuZXRVUkwiLCJwbGFuZXRVUkwiLCJwcm9taXNlcyIsInB1c2giLCJhbGwiLCJtYXAiLCJwbGFuZXRzRGF0YSIsIl9zdG9yZVBsYW5ldERhdGEiLCJfcmVuZGVyUGxhbmV0SXRlbSIsIl9zdGFydEFuaW1hdGlvbiIsImlkIiwiZm9yRWFjaCIsInBsYW5ldERhdGEiLCJuZXdQbGFuZXQiLCJuYW1lIiwidGVycmFpbiIsInBvcHVsYXRpb24iLCJkaWFtZXRlciIsInJlc2lkZW50cyIsImxlbmd0aCIsInJlc2lkZW50VVJMIiwicmVwbGFjZSIsInBsYW5ldERhdGFMb2NhbCIsInBlb3BsZURhdGFMb2NhbCIsInBlcnNvbiIsImluZGV4IiwicGxhbmV0TmFtZSIsImlubmVySFRNTCIsIl9nZXRQZXJzb25QbGFuZXROYW1lIiwicGxhbmV0IiwicGxhbmV0SWQiLCJteVBsYW5ldCIsInBhcnNlSW50IiwibG9hZFNjcmVlbiIsImNsYXNzTGlzdCIsImFkZCIsImxvYWRHaWYiLCJzZXRUaW1lb3V0IiwibWFpbiIsIml0ZW1XcmFwcGVyIiwiZWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsInF1ZXJ5U2VsZWN0b3IiLCJkYXRhIiwiY291bnQiLCJyZW5kZXJMaXN0IiwiX2J1aWxkTGlzdCIsInBlb3BsZU51bWJlciIsInBlb3BsZUxpQ2xvbmUiLCJwZW9wbGVMaSIsImNsb25lTm9kZSIsInBlb3BsZUdyaWQiLCJhcHBlbmRDaGlsZCIsInBlb3BsZU5hbWUiLCJjdXJyZW50UGVyc29uVVJMIiwicGVvcGxlVVJMIiwicGVvcGxlRGF0YSIsIl9zdG9yZVBlb3BsZURhdGEiLCJfcmVuZGVyUGVyc29uSXRlbSIsInBlcnNvbkRhdGEiLCJuZXdQZXJzb24iLCJoZWlnaHQiLCJ3ZWlnaHQiLCJtYXNzIiwiYmlydGhfeWVhciIsImdlbmRlciIsImhvbWV3b3JsZCIsInNwZWNpZXMiXSwibWFwcGluZ3MiOiJBQUFBLFNBQUFBLGNBQUFDLEVBQUFDLEdBb0JBLE9BbkJBLElBQUFDLFFBQUEsU0FBQUMsRUFBQUMsR0FDQSxJQUFBQyxFQUFBLElBQUFDLGVBQ0FELEVBQUFFLEtBQUFOLEVBQUFELEdBQUEsR0FDQUssRUFBQUcsT0FDQUgsRUFBQUksbUJBQUEsV0FDQSxHQUFBLElBQUFKLEVBQUFLLFdBQ0EsR0FBQSxNQUFBTCxFQUFBTSxPQUFBLENBQ0EsSUFBQUMsRUFBQVAsRUFBQVEsYUFDQUMsRUFBQUMsS0FBQUMsTUFBQUosR0FDQVQsRUFBQVcsUUFFQVYsRUFBQUMsRUFBQU0sV0FXQSxTQUFBTSxhQUFBQyxHQUNBQyxRQUFBQyxJQUFBLHFCQUFBVCxRQUdBLFNBQUFVLFFBQUFDLEdBQ0EsT0FBQUEsRUFBQUMsS0FBQSxTQUFBQyxHQUFBLE9BQUFBLFNBQUFBLEVBQUFiLE9BQUEsYUFDQSxTQUFBYyxHQUFBLE9BQUFBLFNBQUFBLEVBQUFkLE9BQUEsY0M3QkEsU0FBQWUsZ0JBZ0JBLFNBQUFDLEVBQUFDLEdBQ0EsSUFBQSxJQUFBQyxFQUFBLEVBQUFBLEdBQUFELEVBQUFDLElBQ0FDLGlCQUFBQyxFQUFBRixFQUNBRyxFQUFBQyxLQUFBbEMsY0FB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N0MsZ0JBQUFwQixLQUFBMEQsR0FFQW5ELE1BSUEsU0FBQWlELElBQ0FwQyxnQkFBQVosUUFBQSxTQUFBYSxFQUFBQyxHQUNBNkIsRUFBQTdCLEdBQUFFLFVBQUFILEVBQUFWLE9BL0RBLElBRUF3QyxFQUZBRixFQUFBWCxTQUFBRSxjQUFBLHNCQUNBTyxFQUFBVCxTQUFBRSxjQUFBLHNCQUdBYSxFQUFBLCtCQUNBdEQsS0FFQWpDLGNBQUF1RixFQUFBLE9BQUEvRCxLQUVBLFNBQUFtRCxHQUNBLElBQUFJLEVBQUFKLEVBQUFDLE1BQ0FFLEVBQUFDLEdBQ0FuRCxFQUFBbUQsSUFMQTdELGNBUkEiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gcmVxdWVzdFNXSW5mbyh1cmwsIG1ldGhvZFR5cGUpe1xuICB2YXIgcHJvbWlzZU9iaiA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHhoci5vcGVuKG1ldGhvZFR5cGUsIHVybCwgdHJ1ZSk7XG4gICAgeGhyLnNlbmQoKTtcbiAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKXtcbiAgICAgIGlmKHhoci5yZWFkeVN0YXRlID09PSA0KXtcbiAgICAgICAgIGlmKHhoci5zdGF0dXMgPT09IDIwMCl7XG4gICAgICAgICAgdmFyIHJlc3AgPSB4aHIucmVzcG9uc2VUZXh0O1xuICAgICAgICAgICAgdmFyIHJlc3BKc29uID0gSlNPTi5wYXJzZShyZXNwKTtcbiAgICAgICAgICAgIHJlc29sdmUocmVzcEpzb24pO1xuICAgICAgICAgfSBlbHNle1xuICAgICAgICAgICAgcmVqZWN0KHhoci5zdGF0dXMpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJ4aHIgZmFpbGVkXCIpOyAvLyBUT0RPOiBhcHBlbmQgJ2NhbnQgZmluZCcgbXNnXG4gICAgICAgICAgIH1cbiAgICAgIH0gZWxzZXtcbiAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwieGhyIHByb2Nlc3NpbmcgZ29pbmcgb25cIik7IC8vIFRPRE86IGFkZCBsb2FkaW5nIGFuaW1hdGlvblxuICAgICAgICAgfVxuICAgIH07XG4gIH0pO1xuICByZXR1cm4gcHJvbWlzZU9iajtcbn1cblxuZnVuY3Rpb24gZXJyb3JIYW5kbGVyKHN0YXR1c0NvZGUpe1xuICBjb25zb2xlLmxvZyhcImZhaWxlZCB3aXRoIHN0YXR1c1wiLCBzdGF0dXMpO1xufVxuXG5mdW5jdGlvbiByZWZsZWN0KHByb21pc2Upe1xuICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc29sdmVkKXsgcmV0dXJuIHtyZXNvbHZlZDpyZXNvbHZlZCwgc3RhdHVzOiBcInJlc29sdmVkXCIgfTt9LFxuICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHJlamVjdGVkKXsgcmV0dXJuIHtyZWplY3RlZDpyZWplY3RlZCwgc3RhdHVzOiBcInJlamVjdGVkXCIgfTt9KTtcbn1cblxudmFyIHBlb3BsZURhdGFMb2NhbCA9IFtdO1xudmFyIHBsYW5ldERhdGFMb2NhbCA9IFtdO1xuIiwiZnVuY3Rpb24gZ2V0UGxhbmV0RGF0YSgpe1xuICB2YXIgcGxhbmV0TmFtZSAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGVvcGxlLWxpc3RfX3BsYW5ldCcpO1xuICB2YXIgaXRlbVdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGVvcGxlLWxpc3RfX2l0ZW0td3JhcHBlcicpO1xuICB2YXIgbWFpbiAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbicpO1xuICB2YXIgbG9hZFNjcmVlbiAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubG9hZC1zY3JlZW4nKTtcbiAgdmFyIGxvYWRHaWYgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxvYWQtc2NyZWVuX19pbWcnKTtcbiAgdmFyIHBsYW5ldFVSTCAgID0gJ2h0dHBzOi8vc3dhcGkuY28vYXBpL3BsYW5ldHMvJztcbiAgdmFyIHByb21pc2VzICAgID0gW107XG5cbiAgcmVxdWVzdFNXSW5mbyhwbGFuZXRVUkwsIFwiR0VUXCIpLnRoZW4oX3N0YXJ0TGlzdCwgZXJyb3JIYW5kbGVyKTtcblxuICBmdW5jdGlvbiBfc3RhcnRMaXN0KGRhdGEpIHtcbiAgICB2YXIgcGxhbmV0TnVtYmVyID0gZGF0YS5jb3VudDtcbiAgICBfcG9wdWxhdGVMaXN0KHBsYW5ldE51bWJlcik7XG4gIH1cblxuICBmdW5jdGlvbiBfcG9wdWxhdGVMaXN0KHBsYW5ldE51bWJlcikge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IHBsYW5ldE51bWJlcjsgaSsrKSB7XG4gICAgICBjdXJyZW50UGxhbmV0VVJMID0gcGxhbmV0VVJMICsgaTtcbiAgICAgIHByb21pc2VzLnB1c2gocmVxdWVzdFNXSW5mbyhjdXJyZW50UGxhbmV0VVJMLCBcIkdFVFwiKSk7XG4gICAgfVxuICAgIFByb21pc2UuYWxsKHByb21pc2VzLm1hcChyZWZsZWN0KSkudGhlbihmdW5jdGlvbihwbGFuZXRzRGF0YSl7XG4gICAgICBfc3RvcmVQbGFuZXREYXRhKHBsYW5ldHNEYXRhKTtcbiAgICAgIF9yZW5kZXJQbGFuZXRJdGVtKCk7XG4gICAgICBfc3RhcnRBbmltYXRpb24oKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9zdG9yZVBsYW5ldERhdGEocGxhbmV0c0RhdGEpIHtcbiAgICB2YXIgaWQgPSAxO1xuICAgIHBsYW5ldHNEYXRhLmZvckVhY2goZnVuY3Rpb24ocGxhbmV0RGF0YSkge1xuICAgICAgaWYgKHBsYW5ldERhdGEucmVzb2x2ZWQpIHtcbiAgICAgICAgdmFyIG5ld1BsYW5ldCA9IHtcbiAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgbmFtZTogcGxhbmV0RGF0YS5yZXNvbHZlZC5uYW1lLFxuICAgICAgICAgIHRlcnJhaW46IHBsYW5ldERhdGEucmVzb2x2ZWQudGVycmFpbixcbiAgICAgICAgICBwb3B1bGF0aW9uOiBwbGFuZXREYXRhLnJlc29sdmVkLnBvcHVsYXRpb24sXG4gICAgICAgICAgZGlhbWV0ZXI6IHBsYW5ldERhdGEucmVzb2x2ZWQuZGlhbWV0ZXJcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAocGxhbmV0RGF0YS5yZXNvbHZlZC5yZXNpZGVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgbmV3UGxhbmV0LnJlc2lkZW50cyA9IHBsYW5ldERhdGEucmVzb2x2ZWQucmVzaWRlbnRzLm1hcChmdW5jdGlvbihyZXNpZGVudFVSTCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc2lkZW50VVJMLnJlcGxhY2UoL1teMC05XS9nLCcnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdQbGFuZXQucmVzaWRlbnRzID0gXCJ1bmtub3duXCI7XG4gICAgICAgIH1cbiAgICAgICAgcGxhbmV0RGF0YUxvY2FsLnB1c2gobmV3UGxhbmV0KTtcbiAgICAgIH1cbiAgICAgIGlkKys7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBfcmVuZGVyUGxhbmV0SXRlbSgpIHtcbiAgICBwZW9wbGVEYXRhTG9jYWwuZm9yRWFjaCggZnVuY3Rpb24ocGVyc29uLCBpbmRleCkge1xuICAgICAgcGxhbmV0TmFtZVtpbmRleF0uaW5uZXJIVE1MID0gX2dldFBlcnNvblBsYW5ldE5hbWUocGVyc29uLnBsYW5ldCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBfZ2V0UGVyc29uUGxhbmV0TmFtZShwbGFuZXRJZCkge1xuICAgIHZhciBteVBsYW5ldCA9ICcnO1xuICAgIHBsYW5ldERhdGFMb2NhbC5mb3JFYWNoKGZ1bmN0aW9uKHBsYW5ldCkge1xuICAgICAgaWYgKHBsYW5ldC5pZCA9PT0gcGFyc2VJbnQocGxhbmV0SWQpKSB7XG4gICAgICAgIG15UGxhbmV0ID0gcGxhbmV0Lm5hbWU7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gbXlQbGFuZXQ7XG4gIH1cblxuICBmdW5jdGlvbiBfc3RhcnRBbmltYXRpb24oKSB7XG4gICAgbG9hZFNjcmVlbi5jbGFzc0xpc3QuYWRkKCdsb2FkLXNjcmVlbi0tZmFkZW91dCcpO1xuICAgIGxvYWRHaWYuY2xhc3NMaXN0LmFkZCgnbG9hZC1zY3JlZW5fX2ltZy0tbW92ZW91dCcpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBtYWluLmNsYXNzTGlzdC5hZGQoJ21haW4tLXNob3cnKTtcbiAgICB9LCAxMDAwKTtcbiAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBpdGVtV3JhcHBlci5mb3JFYWNoKCBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncGVvcGxlLWxpc3RfX2l0ZW0td3JhcHBlci0tc2hvdy1pdGVtcycpO1xuICAgICAgfSk7XG4gICAgfSwgMTIwMCk7XG4gIH1cbn1cbiIsInZhciByZW5kZXJMaXN0ID0gKGZ1bmN0aW9uKCkge1xuICB2YXIgcGVvcGxlR3JpZCAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wZW9wbGUtbGlzdF9fZ3JpZCcpO1xuICB2YXIgcGVvcGxlTGkgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wZW9wbGUtbGlzdF9faXRlbScpO1xuICB2YXIgcGVvcGxlTmFtZTtcblxuICB2YXIgcGVvcGxlVVJMID0gJ2h0dHBzOi8vc3dhcGkuY28vYXBpL3Blb3BsZS8nO1xuICB2YXIgcHJvbWlzZXMgPSBbXTtcblxuICByZXF1ZXN0U1dJbmZvKHBlb3BsZVVSTCwgXCJHRVRcIikudGhlbihfc3RhcnRMaXN0LCBlcnJvckhhbmRsZXIpO1xuXG4gIGZ1bmN0aW9uIF9zdGFydExpc3QoZGF0YSkge1xuICAgIHZhciBwZW9wbGVOdW1iZXIgPSBkYXRhLmNvdW50O1xuICAgIF9idWlsZExpc3QocGVvcGxlTnVtYmVyKTtcbiAgICBfcG9wdWxhdGVMaXN0KHBlb3BsZU51bWJlcik7XG4gIH1cblxuICBmdW5jdGlvbiBfYnVpbGRMaXN0KHBlb3BsZU51bWJlcikge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgcGVvcGxlTnVtYmVyOyBpKz0yKSB7XG4gICAgICB2YXIgcGVvcGxlTGlDbG9uZSA9IHBlb3BsZUxpLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIHBlb3BsZUdyaWQuYXBwZW5kQ2hpbGQocGVvcGxlTGlDbG9uZSk7XG4gICAgfVxuICAgIHBlb3BsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGVvcGxlLWxpc3RfX25hbWUnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9wb3B1bGF0ZUxpc3QocGVvcGxlTnVtYmVyKSB7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gcGVvcGxlTnVtYmVyOyBpKyspIHtcbiAgICAgIGN1cnJlbnRQZXJzb25VUkwgPSBwZW9wbGVVUkwgKyBpO1xuICAgICAgcHJvbWlzZXMucHVzaChyZXF1ZXN0U1dJbmZvKGN1cnJlbnRQZXJzb25VUkwsIFwiR0VUXCIpKTtcbiAgICB9XG4gICAgUHJvbWlzZS5hbGwocHJvbWlzZXMubWFwKHJlZmxlY3QpKS50aGVuKGZ1bmN0aW9uKHBlb3BsZURhdGEpe1xuICAgICAgX3N0b3JlUGVvcGxlRGF0YShwZW9wbGVEYXRhKTtcbiAgICAgIF9yZW5kZXJQZXJzb25JdGVtKCk7XG4gICAgICBnZXRQbGFuZXREYXRhKCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBfc3RvcmVQZW9wbGVEYXRhKHBlb3BsZURhdGEpIHtcbiAgICB2YXIgaWQgPSAxO1xuICAgIHBlb3BsZURhdGEuZm9yRWFjaChmdW5jdGlvbihwZXJzb25EYXRhKSB7XG4gICAgICBpZiAocGVyc29uRGF0YS5yZXNvbHZlZCkge1xuICAgICAgICB2YXIgbmV3UGVyc29uID0ge1xuICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICBuYW1lOiBwZXJzb25EYXRhLnJlc29sdmVkLm5hbWUsXG4gICAgICAgICAgaGVpZ2h0OiBwZXJzb25EYXRhLnJlc29sdmVkLmhlaWdodCxcbiAgICAgICAgICB3ZWlnaHQ6IHBlcnNvbkRhdGEucmVzb2x2ZWQubWFzcyxcbiAgICAgICAgICBiaXJ0aF95ZWFyOiBwZXJzb25EYXRhLnJlc29sdmVkLmJpcnRoX3llYXIsXG4gICAgICAgICAgZ2VuZGVyOiBwZXJzb25EYXRhLnJlc29sdmVkLmdlbmRlclxuICAgICAgICB9O1xuICAgICAgICBwZXJzb25EYXRhLnJlc29sdmVkLmhvbWV3b3JsZCA/XG4gICAgICAgIG5ld1BlcnNvbi5wbGFuZXQgPSBwZXJzb25EYXRhLnJlc29sdmVkLmhvbWV3b3JsZC5yZXBsYWNlKC9bXjAtOV0vZywnJykgOlxuICAgICAgICBuZXdQZXJzb24ucGxhbmV0ID0gXCJ1bmtub3duXCI7XG5cbiAgICAgICAgcGVyc29uRGF0YS5yZXNvbHZlZC5zcGVjaWVzWzBdID9cbiAgICAgICAgbmV3UGVyc29uLnNwZWNpZXMgPSBwZXJzb25EYXRhLnJlc29sdmVkLnNwZWNpZXNbMF0ucmVwbGFjZSgvW14wLTldL2csJycpIDpcbiAgICAgICAgbmV3UGVyc29uLnNwZWNpZXMgPSBcInVua25vd25cIjtcblxuICAgICAgICBwZW9wbGVEYXRhTG9jYWwucHVzaChuZXdQZXJzb24pO1xuICAgICAgfVxuICAgICAgaWQrKztcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZW5kZXJQZXJzb25JdGVtKCkge1xuICAgIHBlb3BsZURhdGFMb2NhbC5mb3JFYWNoKCBmdW5jdGlvbihwZXJzb24sIGluZGV4KSB7XG4gICAgICBwZW9wbGVOYW1lW2luZGV4XS5pbm5lckhUTUwgPSBwZXJzb24ubmFtZTtcbiAgICB9KTtcbiAgfVxufSkoKTtcbiJdfQ==
