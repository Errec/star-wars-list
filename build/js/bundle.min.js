function requestSWInfo(e,t){return new Promise(function(n,r){var a=new XMLHttpRequest;a.open(t,e,!0),a.send(),a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status){var e=a.responseText,t=JSON.parse(e);n(t)}else r(a.status)}})}function errorHandler(e){console.log("failed with status",status)}function reflect(e){return e.then(function(e){return{resolved:e,status:"resolved"}},function(e){return{rejected:e,status:"rejected"}})}function getPlanetData(){function e(e){for(var r=1;r<=e;r++)currentPlanetURL=c+r,u.push(requestSWInfo(currentPlanetURL,"GET"));Promise.all(u.map(reflect)).then(function(e){t(e),n(),a()})}function t(e){var t=1;e.forEach(function(e){if(e.resolved){var n={id:t,name:e.resolved.name,terrain:e.resolved.terrain,population:e.resolved.population,diameter:e.resolved.diameter};e.resolved.residents.length?n.residents=e.resolved.residents.map(function(e){return e.replace(/[^0-9]/g,"")}):n.residents="unknown",planetDataLocal.push(n)}t++})}function n(){peopleDataLocal.forEach(function(e,t){var n=r(e.planet);o[t].innerHTML=n,o[t].dataset.planet=n})}function r(e){var t="";return planetDataLocal.forEach(function(n){n.id!==parseInt(e)||(t=n.name)}),t}function a(){i.classList.add("load-screen--fadeout"),p.classList.add("load-screen__img--moveout"),setTimeout(function(){s.classList.add("main--show")},1e3),setTimeout(function(){l.forEach(function(e){e.classList.add("people-list__item-wrapper--show-items")})},1200)}var o=document.querySelectorAll(".people-list__planet"),l=document.querySelectorAll(".people-list__item-wrapper"),s=document.querySelector(".main"),i=document.querySelector(".load-screen"),p=document.querySelector(".load-screen__img"),c="https://swapi.co/api/planets/",u=[];requestSWInfo(c,"GET").then(function(t){e(t.count)},errorHandler)}var peopleDataLocal=[],planetDataLocal=[],peopleName,peopleWrapper,renderList=function(){function e(e){for(var t=1;t<e;t+=2){var n=o.cloneNode(!0);a.appendChild(n)}peopleName=document.querySelectorAll(".people-list__name"),peopleWrapper=document.querySelectorAll(".people-list__item-wrapper")}function t(e){for(var t=1;t<=e;t++)currentPersonURL=l+t,s.push(requestSWInfo(currentPersonURL,"GET"));Promise.all(s.map(reflect)).then(function(e){n(e),r(),getPlanetData()})}function n(e){var t=1;e.forEach(function(e){if(e.resolved){var n={id:t,name:e.resolved.name,height:e.resolved.height,weight:e.resolved.mass,birth_year:e.resolved.birth_year,gender:e.resolved.gender};e.resolved.homeworld?n.planet=e.resolved.homeworld.replace(/[^0-9]/g,""):n.planet="unknown",e.resolved.species[0]?n.species=e.resolved.species[0].replace(/[^0-9]/g,""):n.species="unknown",peopleDataLocal.push(n)}t++})}function r(){peopleDataLocal.forEach(function(e,t){peopleName[t].dataset.name=e.name,peopleName[t].innerHTML=e.name,peopleName[t].parentElement.classList.add("people-list__item-wrapper--show")})}var a=document.querySelector(".people-list__grid"),o=document.querySelector(".people-list__item"),l="https://swapi.co/api/people/",s=[];requestSWInfo(l,"GET").then(function(n){var r=n.count;e(r),t(r)},errorHandler)}(),search=function(){function e(){term=t.value;var e=new RegExp(term,"gi");peopleWrapper.forEach(function(t){t.children[0].dataset.name&&(t.children[0].dataset.name.match(e)||t.children[1].dataset.planet.match(e)?t.classList.add("people-list__item-wrapper--show"):t.classList.remove("people-list__item-wrapper--show"))})}var t=document.querySelector(".header__input");document.querySelectorAll(".people-list__planet");t.addEventListener("change",e),t.addEventListener("keyup",e)}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9tYWluLmpzIiwicGxhbmV0LWxpc3QuanMiLCJwZW9wbGUtbGlzdC5qcyIsInNlYXJjaC5qcyJdLCJuYW1lcyI6WyJyZXF1ZXN0U1dJbmZvIiwidXJsIiwibWV0aG9kVHlwZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwic2VuZCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJyZXNwIiwicmVzcG9uc2VUZXh0IiwicmVzcEpzb24iLCJKU09OIiwicGFyc2UiLCJlcnJvckhhbmRsZXIiLCJzdGF0dXNDb2RlIiwiY29uc29sZSIsImxvZyIsInJlZmxlY3QiLCJwcm9taXNlIiwidGhlbiIsInJlc29sdmVkIiwicmVqZWN0ZWQiLCJnZXRQbGFuZXREYXRhIiwiX3BvcHVsYXRlTGlzdCIsInBsYW5ldE51bWJlciIsImkiLCJjdXJyZW50UGxhbmV0VVJMIiwicGxhbmV0VVJMIiwicHJvbWlzZXMiLCJwdXNoIiwiYWxsIiwibWFwIiwicGxhbmV0c0RhdGEiLCJfc3RvcmVQbGFuZXREYXRhIiwiX3JlbmRlclBsYW5ldEl0ZW0iLCJfc3RhcnRBbmltYXRpb24iLCJpZCIsImZvckVhY2giLCJwbGFuZXREYXRhIiwibmV3UGxhbmV0IiwibmFtZSIsInRlcnJhaW4iLCJwb3B1bGF0aW9uIiwiZGlhbWV0ZXIiLCJyZXNpZGVudHMiLCJsZW5ndGgiLCJyZXNpZGVudFVSTCIsInJlcGxhY2UiLCJwbGFuZXREYXRhTG9jYWwiLCJwZW9wbGVEYXRhTG9jYWwiLCJwZXJzb24iLCJpbmRleCIsInBlcnNvblBsYW5ldCIsIl9nZXRQZXJzb25QbGFuZXROYW1lIiwicGxhbmV0IiwicGxhbmV0TmFtZSIsImlubmVySFRNTCIsImRhdGFzZXQiLCJwbGFuZXRJZCIsIm15UGxhbmV0IiwicGFyc2VJbnQiLCJsb2FkU2NyZWVuIiwiY2xhc3NMaXN0IiwiYWRkIiwibG9hZEdpZiIsInNldFRpbWVvdXQiLCJtYWluIiwiaXRlbVdyYXBwZXIiLCJlbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwicXVlcnlTZWxlY3RvciIsImRhdGEiLCJjb3VudCIsInBlb3BsZU5hbWUiLCJwZW9wbGVXcmFwcGVyIiwicmVuZGVyTGlzdCIsIl9idWlsZExpc3QiLCJwZW9wbGVOdW1iZXIiLCJwZW9wbGVMaUNsb25lIiwicGVvcGxlTGkiLCJjbG9uZU5vZGUiLCJwZW9wbGVHcmlkIiwiYXBwZW5kQ2hpbGQiLCJjdXJyZW50UGVyc29uVVJMIiwicGVvcGxlVVJMIiwicGVvcGxlRGF0YSIsIl9zdG9yZVBlb3BsZURhdGEiLCJfcmVuZGVyUGVyc29uSXRlbSIsInBlcnNvbkRhdGEiLCJuZXdQZXJzb24iLCJoZWlnaHQiLCJ3ZWlnaHQiLCJtYXNzIiwiYmlydGhfeWVhciIsImdlbmRlciIsImhvbWV3b3JsZCIsInNwZWNpZXMiLCJwYXJlbnRFbGVtZW50Iiwic2VhcmNoIiwiX2ZpbHRlck1hdGNoZXMiLCJ0ZXJtIiwic2VhcmNoSW5wdXQiLCJ2YWx1ZSIsInJlZ2V4IiwiUmVnRXhwIiwicGVyc29uV3JhcHBlciIsImNoaWxkcmVuIiwibWF0Y2giLCJyZW1vdmUiLCJhZGRFdmVudExpc3RlbmVyIl0sIm1hcHBpbmdzIjoiQUFLQSxTQUFBQSxjQUFBQyxFQUFBQyxHQW9CQSxPQW5CQSxJQUFBQyxRQUFBLFNBQUFDLEVBQUFDLEdBQ0EsSUFBQUMsRUFBQSxJQUFBQyxlQUNBRCxFQUFBRSxLQUFBTixFQUFBRCxHQUFBLEdBQ0FLLEVBQUFHLE9BQ0FILEVBQUFJLG1CQUFBLFdBQ0EsR0FBQSxJQUFBSixFQUFBSyxXQUNBLEdBQUEsTUFBQUwsRUFBQU0sT0FBQSxDQUNBLElBQUFDLEVBQUFQLEVBQUFRLGFBQ0FDLEVBQUFDLEtBQUFDLE1BQUFKLEdBQ0FULEVBQUFXLFFBRUFWLEVBQUFDLEVBQUFNLFdBV0EsU0FBQU0sYUFBQUMsR0FDQUMsUUFBQUMsSUFBQSxxQkFBQVQsUUFHQSxTQUFBVSxRQUFBQyxH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K0MsT0FBQSxzQ0FiQSxJQUFBUCxFQUFBakMsU0FBQUUsY0FBQSxrQkFDQUYsU0FBQUMsaUJBQUEsd0JBRUFnQyxFQUFBUSxpQkFBQSxTQUFBVixHQUNBRSxFQUFBUSxpQkFBQSxRQUFBVixHQUxBIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBwZW9wbGVEYXRhTG9jYWwgPSBbXTtcbnZhciBwbGFuZXREYXRhTG9jYWwgPSBbXTtcbnZhciBwZW9wbGVOYW1lOyAvLyBob2xkIHBlb3BsZSBsaXN0IG5hbWUgRE9NIGVsXG52YXIgcGVvcGxlV3JhcHBlcjsgLy8gaG9sZCBwZW9wbGUgbGlzdCB3cmFwcGVyIERPTSBlbFxuXG5mdW5jdGlvbiByZXF1ZXN0U1dJbmZvKHVybCwgbWV0aG9kVHlwZSl7XG4gIHZhciBwcm9taXNlT2JqID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgeGhyLm9wZW4obWV0aG9kVHlwZSwgdXJsLCB0cnVlKTtcbiAgICB4aHIuc2VuZCgpO1xuICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpe1xuICAgICAgaWYoeGhyLnJlYWR5U3RhdGUgPT09IDQpe1xuICAgICAgICAgaWYoeGhyLnN0YXR1cyA9PT0gMjAwKXtcbiAgICAgICAgICB2YXIgcmVzcCA9IHhoci5yZXNwb25zZVRleHQ7XG4gICAgICAgICAgICB2YXIgcmVzcEpzb24gPSBKU09OLnBhcnNlKHJlc3ApO1xuICAgICAgICAgICAgcmVzb2x2ZShyZXNwSnNvbik7XG4gICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICByZWplY3QoeGhyLnN0YXR1cyk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInhociBmYWlsZWRcIik7IC8vIFRPRE86IGFwcGVuZCAnY2FudCBmaW5kJyBtc2dcbiAgICAgICAgICAgfVxuICAgICAgfSBlbHNle1xuICAgICAgICAgLy8gY29uc29sZS5sb2coXCJ4aHIgcHJvY2Vzc2luZyBnb2luZyBvblwiKTsgLy8gVE9ETzogYWRkIGxvYWRpbmcgYW5pbWF0aW9uXG4gICAgICAgICB9XG4gICAgfTtcbiAgfSk7XG4gIHJldHVybiBwcm9taXNlT2JqO1xufVxuXG5mdW5jdGlvbiBlcnJvckhhbmRsZXIoc3RhdHVzQ29kZSl7XG4gIGNvbnNvbGUubG9nKFwiZmFpbGVkIHdpdGggc3RhdHVzXCIsIHN0YXR1cyk7XG59XG5cbmZ1bmN0aW9uIHJlZmxlY3QocHJvbWlzZSl7XG4gIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzb2x2ZWQpeyByZXR1cm4ge3Jlc29sdmVkOnJlc29sdmVkLCBzdGF0dXM6IFwicmVzb2x2ZWRcIiB9O30sXG4gICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ocmVqZWN0ZWQpeyByZXR1cm4ge3JlamVjdGVkOnJlamVjdGVkLCBzdGF0dXM6IFwicmVqZWN0ZWRcIiB9O30pO1xufVxuIiwiZnVuY3Rpb24gZ2V0UGxhbmV0RGF0YSgpe1xuICB2YXIgcGxhbmV0TmFtZSAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGVvcGxlLWxpc3RfX3BsYW5ldCcpO1xuICB2YXIgaXRlbVdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGVvcGxlLWxpc3RfX2l0ZW0td3JhcHBlcicpO1xuICB2YXIgbWFpbiAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbicpO1xuICB2YXIgbG9hZFNjcmVlbiAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubG9hZC1zY3JlZW4nKTtcbiAgdmFyIGxvYWRHaWYgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxvYWQtc2NyZWVuX19pbWcnKTtcbiAgdmFyIHBsYW5ldFVSTCAgID0gJ2h0dHBzOi8vc3dhcGkuY28vYXBpL3BsYW5ldHMvJztcbiAgdmFyIHByb21pc2VzICAgID0gW107XG5cbiAgcmVxdWVzdFNXSW5mbyhwbGFuZXRVUkwsIFwiR0VUXCIpLnRoZW4oX3N0YXJ0TGlzdCwgZXJyb3JIYW5kbGVyKTtcblxuICBmdW5jdGlvbiBfc3RhcnRMaXN0KGRhdGEpIHtcbiAgICB2YXIgcGxhbmV0TnVtYmVyID0gZGF0YS5jb3VudDtcbiAgICBfcG9wdWxhdGVMaXN0KHBsYW5ldE51bWJlcik7XG4gIH1cblxuICBmdW5jdGlvbiBfcG9wdWxhdGVMaXN0KHBsYW5ldE51bWJlcikge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IHBsYW5ldE51bWJlcjsgaSsrKSB7XG4gICAgICBjdXJyZW50UGxhbmV0VVJMID0gcGxhbmV0VVJMICsgaTtcbiAgICAgIHByb21pc2VzLnB1c2gocmVxdWVzdFNXSW5mbyhjdXJyZW50UGxhbmV0VVJMLCBcIkdFVFwiKSk7XG4gICAgfVxuICAgIFByb21pc2UuYWxsKHByb21pc2VzLm1hcChyZWZsZWN0KSkudGhlbihmdW5jdGlvbihwbGFuZXRzRGF0YSl7XG4gICAgICBfc3RvcmVQbGFuZXREYXRhKHBsYW5ldHNEYXRhKTtcbiAgICAgIF9yZW5kZXJQbGFuZXRJdGVtKCk7XG4gICAgICBfc3RhcnRBbmltYXRpb24oKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9zdG9yZVBsYW5ldERhdGEocGxhbmV0c0RhdGEpIHtcbiAgICB2YXIgaWQgPSAxO1xuICAgIHBsYW5ldHNEYXRhLmZvckVhY2goZnVuY3Rpb24ocGxhbmV0RGF0YSkge1xuICAgICAgaWYgKHBsYW5ldERhdGEucmVzb2x2ZWQpIHtcbiAgICAgICAgdmFyIG5ld1BsYW5ldCA9IHtcbiAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgbmFtZTogcGxhbmV0RGF0YS5yZXNvbHZlZC5uYW1lLFxuICAgICAgICAgIHRlcnJhaW46IHBsYW5ldERhdGEucmVzb2x2ZWQudGVycmFpbixcbiAgICAgICAgICBwb3B1bGF0aW9uOiBwbGFuZXREYXRhLnJlc29sdmVkLnBvcHVsYXRpb24sXG4gICAgICAgICAgZGlhbWV0ZXI6IHBsYW5ldERhdGEucmVzb2x2ZWQuZGlhbWV0ZXJcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAocGxhbmV0RGF0YS5yZXNvbHZlZC5yZXNpZGVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgbmV3UGxhbmV0LnJlc2lkZW50cyA9IHBsYW5ldERhdGEucmVzb2x2ZWQucmVzaWRlbnRzLm1hcChmdW5jdGlvbihyZXNpZGVudFVSTCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc2lkZW50VVJMLnJlcGxhY2UoL1teMC05XS9nLCcnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdQbGFuZXQucmVzaWRlbnRzID0gXCJ1bmtub3duXCI7XG4gICAgICAgIH1cbiAgICAgICAgcGxhbmV0RGF0YUxvY2FsLnB1c2gobmV3UGxhbmV0KTtcbiAgICAgIH1cbiAgICAgIGlkKys7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBfcmVuZGVyUGxhbmV0SXRlbSgpIHtcbiAgICBwZW9wbGVEYXRhTG9jYWwuZm9yRWFjaCggZnVuY3Rpb24ocGVyc29uLCBpbmRleCkge1xuICAgICAgdmFyIHBlcnNvblBsYW5ldCA9IF9nZXRQZXJzb25QbGFuZXROYW1lKHBlcnNvbi5wbGFuZXQpO1xuICAgICAgcGxhbmV0TmFtZVtpbmRleF0uaW5uZXJIVE1MID0gcGVyc29uUGxhbmV0O1xuICAgICAgcGxhbmV0TmFtZVtpbmRleF0uZGF0YXNldC5wbGFuZXQgPSBwZXJzb25QbGFuZXQ7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBfZ2V0UGVyc29uUGxhbmV0TmFtZShwbGFuZXRJZCkge1xuICAgIHZhciBteVBsYW5ldCA9ICcnO1xuICAgIHBsYW5ldERhdGFMb2NhbC5mb3JFYWNoKGZ1bmN0aW9uKHBsYW5ldCkge1xuICAgICAgaWYgKHBsYW5ldC5pZCA9PT0gcGFyc2VJbnQocGxhbmV0SWQpKSB7XG4gICAgICAgIG15UGxhbmV0ID0gcGxhbmV0Lm5hbWU7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gbXlQbGFuZXQ7XG4gIH1cblxuICBmdW5jdGlvbiBfc3RhcnRBbmltYXRpb24oKSB7XG4gICAgbG9hZFNjcmVlbi5jbGFzc0xpc3QuYWRkKCdsb2FkLXNjcmVlbi0tZmFkZW91dCcpO1xuICAgIGxvYWRHaWYuY2xhc3NMaXN0LmFkZCgnbG9hZC1zY3JlZW5fX2ltZy0tbW92ZW91dCcpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBtYWluLmNsYXNzTGlzdC5hZGQoJ21haW4tLXNob3cnKTtcbiAgICB9LCAxMDAwKTtcbiAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBpdGVtV3JhcHBlci5mb3JFYWNoKCBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncGVvcGxlLWxpc3RfX2l0ZW0td3JhcHBlci0tc2hvdy1pdGVtcycpO1xuICAgICAgfSk7XG4gICAgfSwgMTIwMCk7XG4gIH1cbn1cbiIsInZhciByZW5kZXJMaXN0ID0gKGZ1bmN0aW9uKCkge1xuICB2YXIgcGVvcGxlR3JpZCAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wZW9wbGUtbGlzdF9fZ3JpZCcpO1xuICB2YXIgcGVvcGxlTGkgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wZW9wbGUtbGlzdF9faXRlbScpO1xuXG4gIHZhciBwZW9wbGVVUkwgPSAnaHR0cHM6Ly9zd2FwaS5jby9hcGkvcGVvcGxlLyc7XG4gIHZhciBwcm9taXNlcyA9IFtdO1xuXG4gIHJlcXVlc3RTV0luZm8ocGVvcGxlVVJMLCBcIkdFVFwiKS50aGVuKF9zdGFydExpc3QsIGVycm9ySGFuZGxlcik7XG5cbiAgZnVuY3Rpb24gX3N0YXJ0TGlzdChkYXRhKSB7XG4gICAgdmFyIHBlb3BsZU51bWJlciA9IGRhdGEuY291bnQ7XG4gICAgX2J1aWxkTGlzdChwZW9wbGVOdW1iZXIpO1xuICAgIF9wb3B1bGF0ZUxpc3QocGVvcGxlTnVtYmVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9idWlsZExpc3QocGVvcGxlTnVtYmVyKSB7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBwZW9wbGVOdW1iZXI7IGkrPTIpIHtcbiAgICAgIHZhciBwZW9wbGVMaUNsb25lID0gcGVvcGxlTGkuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgcGVvcGxlR3JpZC5hcHBlbmRDaGlsZChwZW9wbGVMaUNsb25lKTtcbiAgICB9XG4gICAgcGVvcGxlTmFtZSAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wZW9wbGUtbGlzdF9fbmFtZScpO1xuICAgIHBlb3BsZVdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGVvcGxlLWxpc3RfX2l0ZW0td3JhcHBlcicpO1xuICB9XG5cbiAgZnVuY3Rpb24gX3BvcHVsYXRlTGlzdChwZW9wbGVOdW1iZXIpIHtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8PSBwZW9wbGVOdW1iZXI7IGkrKykge1xuICAgICAgY3VycmVudFBlcnNvblVSTCA9IHBlb3BsZVVSTCArIGk7XG4gICAgICBwcm9taXNlcy5wdXNoKHJlcXVlc3RTV0luZm8oY3VycmVudFBlcnNvblVSTCwgXCJHRVRcIikpO1xuICAgIH1cbiAgICBQcm9taXNlLmFsbChwcm9taXNlcy5tYXAocmVmbGVjdCkpLnRoZW4oZnVuY3Rpb24ocGVvcGxlRGF0YSl7XG4gICAgICBfc3RvcmVQZW9wbGVEYXRhKHBlb3BsZURhdGEpO1xuICAgICAgX3JlbmRlclBlcnNvbkl0ZW0oKTtcbiAgICAgIGdldFBsYW5ldERhdGEoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9zdG9yZVBlb3BsZURhdGEocGVvcGxlRGF0YSkge1xuICAgIHZhciBpZCA9IDE7XG4gICAgcGVvcGxlRGF0YS5mb3JFYWNoKGZ1bmN0aW9uKHBlcnNvbkRhdGEpIHtcbiAgICAgIGlmIChwZXJzb25EYXRhLnJlc29sdmVkKSB7XG4gICAgICAgIHZhciBuZXdQZXJzb24gPSB7XG4gICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgIG5hbWU6IHBlcnNvbkRhdGEucmVzb2x2ZWQubmFtZSxcbiAgICAgICAgICBoZWlnaHQ6IHBlcnNvbkRhdGEucmVzb2x2ZWQuaGVpZ2h0LFxuICAgICAgICAgIHdlaWdodDogcGVyc29uRGF0YS5yZXNvbHZlZC5tYXNzLFxuICAgICAgICAgIGJpcnRoX3llYXI6IHBlcnNvbkRhdGEucmVzb2x2ZWQuYmlydGhfeWVhcixcbiAgICAgICAgICBnZW5kZXI6IHBlcnNvbkRhdGEucmVzb2x2ZWQuZ2VuZGVyXG4gICAgICAgIH07XG4gICAgICAgIHBlcnNvbkRhdGEucmVzb2x2ZWQuaG9tZXdvcmxkID9cbiAgICAgICAgbmV3UGVyc29uLnBsYW5ldCA9IHBlcnNvbkRhdGEucmVzb2x2ZWQuaG9tZXdvcmxkLnJlcGxhY2UoL1teMC05XS9nLCcnKSA6XG4gICAgICAgIG5ld1BlcnNvbi5wbGFuZXQgPSBcInVua25vd25cIjtcblxuICAgICAgICBwZXJzb25EYXRhLnJlc29sdmVkLnNwZWNpZXNbMF0gP1xuICAgICAgICBuZXdQZXJzb24uc3BlY2llcyA9IHBlcnNvbkRhdGEucmVzb2x2ZWQuc3BlY2llc1swXS5yZXBsYWNlKC9bXjAtOV0vZywnJykgOlxuICAgICAgICBuZXdQZXJzb24uc3BlY2llcyA9IFwidW5rbm93blwiO1xuXG4gICAgICAgIHBlb3BsZURhdGFMb2NhbC5wdXNoKG5ld1BlcnNvbik7XG4gICAgICB9XG4gICAgICBpZCsrO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gX3JlbmRlclBlcnNvbkl0ZW0oKSB7XG4gICAgcGVvcGxlRGF0YUxvY2FsLmZvckVhY2goIGZ1bmN0aW9uKHBlcnNvbiwgaW5kZXgpIHtcbiAgICAgIHBlb3BsZU5hbWVbaW5kZXhdLmRhdGFzZXQubmFtZSA9IHBlcnNvbi5uYW1lO1xuICAgICAgcGVvcGxlTmFtZVtpbmRleF0uaW5uZXJIVE1MID0gcGVyc29uLm5hbWU7XG4gICAgICBwZW9wbGVOYW1lW2luZGV4XS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3Blb3BsZS1saXN0X19pdGVtLXdyYXBwZXItLXNob3cnKTtcbiAgICB9KTtcbiAgfVxufSkoKTtcbiIsInZhciBzZWFyY2ggID0gKGZ1bmN0aW9uKCkge1xuICB2YXIgc2VhcmNoSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX19pbnB1dCcpO1xuICB2YXIgcGxhbmV0TmFtZSAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGVvcGxlLWxpc3RfX3BsYW5ldCcpO1xuXG4gIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIF9maWx0ZXJNYXRjaGVzKTtcbiAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBfZmlsdGVyTWF0Y2hlcyk7XG5cbiAgZnVuY3Rpb24gX2ZpbHRlck1hdGNoZXMoKSB7XG4gICAgdGVybSA9IHNlYXJjaElucHV0LnZhbHVlO1xuICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAodGVybSwgJ2dpJyk7XG4gICAgcGVvcGxlV3JhcHBlci5mb3JFYWNoKGZ1bmN0aW9uKHBlcnNvbldyYXBwZXIpIHtcbiAgICAgIGlmKHBlcnNvbldyYXBwZXIuY2hpbGRyZW5bMF0uZGF0YXNldC5uYW1lKSB7XG4gICAgICAgIHBlcnNvbldyYXBwZXIuY2hpbGRyZW5bMF0uZGF0YXNldC5uYW1lLm1hdGNoKHJlZ2V4KSB8fCBwZXJzb25XcmFwcGVyLmNoaWxkcmVuWzFdLmRhdGFzZXQucGxhbmV0Lm1hdGNoKHJlZ2V4KSA/XG4gICAgICAgIHBlcnNvbldyYXBwZXIuY2xhc3NMaXN0LmFkZCgncGVvcGxlLWxpc3RfX2l0ZW0td3JhcHBlci0tc2hvdycpIDpcbiAgICAgICAgcGVyc29uV3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdwZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyLS1zaG93Jyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn0pKCk7XG4iXX0=
