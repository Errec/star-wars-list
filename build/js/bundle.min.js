function renderPersonItem(){peopleDataLocal.forEach(function(e,t){peopleName[t].dataset.name=e.name,peopleName[t].innerHTML=e.name,peopleName[t].parentElement.classList.add("people-list__item-wrapper--show"),peopleName[t].parentElement.classList.remove("people-list__item-wrapper--fade"),searchInput.value=""})}function renderPlanetItem(){var e=document.querySelectorAll(".people-list__planet");peopleDataLocal.forEach(function(t,n){var o=getPersonPlanetName(t.planet);e[n].innerHTML=o,e[n].dataset.planet=o})}function getPersonPlanetName(e){var t="";return planetDataLocal.forEach(function(n){n.id!==parseInt(e)||(t=n.name)}),t}function requestSWInfo(e,t){return new Promise(function(n,o){var a=new XMLHttpRequest;a.open(t,e,!0),a.send(),a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status){var e=a.responseText,t=JSON.parse(e);n(t)}else o(a.status),console.log("xhr failed");else console.log("xhr processing going on")}})}function errorHandler(e){console.log("failed with status",status)}function reflect(e){return e.then(function(e){return{resolved:e,status:"resolved"}},function(e){return{rejected:e,status:"rejected"}})}function getPlanetData(){function e(e){for(var a=1;a<=e;a++)currentPlanetURL=s+a,c.push(requestSWInfo(currentPlanetURL,"GET"));Promise.all(c.map(reflect)).then(function(e){t(e),n(),renderPlanetItem(),o()})}function t(e){var t=1;e.forEach(function(e){if(e.resolved){var n={id:t,name:e.resolved.name,terrain:e.resolved.terrain,population:e.resolved.population,diameter:e.resolved.diameter};e.resolved.residents.length?n.residents=e.resolved.residents.map(function(e){return e.replace(/[^0-9]/g,"")}):n.residents="unknown",planetDataLocal.push(n)}t++})}function n(){peopleDataLocal.forEach(function(e){e.planetName=getPersonPlanetName(e.planet)})}function o(){l.classList.add("load-screen--fadeout"),loadGif.classList.add("load-screen__img--moveout"),loadBalloonImg.classList.remove("load-screen__balloon--show"),setTimeout(function(){r.classList.add("main--show")},1e3),setTimeout(function(){a.forEach(function(e){e.classList.add("people-list__item-wrapper--show-items")})},1200)}var a=document.querySelectorAll(".people-list__item-wrapper"),r=document.querySelector(".main"),l=document.querySelector(".load-screen"),s="https://swapi.co/api/planets/",c=[];requestSWInfo(s,"GET").then(function(t){e(t.count)},errorHandler)}var loadBalloonImg=document.querySelector(".load-screen__balloon"),loadGif=document.querySelector(".load-screen__img"),searchInput=document.querySelector(".header__input"),peopleDataLocal=[],planetDataLocal=[],peopleName,peopleWrapper,renderList=function(){function e(e){for(var t=1;t<e;t+=2){var n=a.cloneNode(!0);o.appendChild(n)}peopleName=document.querySelectorAll(".people-list__name"),peopleWrapper=document.querySelectorAll(".people-list__item-wrapper")}function t(e){for(var t=1;t<=e;t++)currentPersonURL=r+t,l.push(requestSWInfo(currentPersonURL,"GET"));Promise.all(l.map(reflect)).then(function(e){n(e),renderPersonItem(),getPlanetData()})}function n(e){var t=1;e.forEach(function(e){if(e.resolved){var n={id:t,name:e.resolved.name,height:e.resolved.height,weight:e.resolved.mass,birth_year:e.resolved.birth_year,gender:e.resolved.gender};e.resolved.homeworld?n.planet=e.resolved.homeworld.replace(/[^0-9]/g,""):n.planet="Unknown",e.resolved.species[0]?n.species=e.resolved.species[0].replace(/[^0-9]/g,""):n.species="Unknown",peopleDataLocal.push(n)}t++})}var o=document.querySelector(".people-list__grid"),a=document.querySelector(".people-list__item"),r="https://swapi.co/api/people/",l=[];document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){loadGif.classList.add("load-screen__img--movein")},200),setTimeout(function(){loadBalloonImg.classList.add("load-screen__balloon--show")},2200)}),requestSWInfo(r,"GET").then(function(n){var o=n.count;e(o),t(o)},errorHandler)}(),search=function(){function e(){term=searchInput.value;var e=0,t=new RegExp(term,"gi");peopleWrapper.forEach(function(n){n.children[0].dataset.name&&(n.children[0].dataset.name.match(t)||n.children[1].dataset.planet.match(t)?(e++,n.classList.add("people-list__item-wrapper--show"),setTimeout(function(){n.classList.remove("people-list__item-wrapper--fade")},200)):(n.classList.add("people-list__item-wrapper--fade"),setTimeout(function(){n.classList.remove("people-list__item-wrapper--show")},200)))}),0===e?searchInput.classList.add("header__input--no-results"):searchInput.classList.remove("header__input--no-results")}document.querySelectorAll(".people-list__planet");searchInput.addEventListener("change",e),searchInput.addEventListener("keyup",e)}(),sortPeople=function(){var e=document.querySelector(".header__select");e.addEventListener("change",function(){!function(e){peopleDataLocal.sort(function(t,n){return t[e]<n[e]?-1:t[e]>n[e]?1:0})}(e.value),renderPersonItem(),renderPlanetItem()})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9tYWluLmpzIiwicGxhbmV0LWxpc3QuanMiLCJwZW9wbGUtbGlzdC5qcyIsInNlYXJjaC5qcyIsInNvcnRQZW9wbGUuanMiXSwibmFtZXMiOlsicmVuZGVyUGVyc29uSXRlbSIsInBlb3BsZURhdGFMb2NhbCIsImZvckVhY2giLCJwZXJzb24iLCJpbmRleCIsInBlb3BsZU5hbWUiLCJkYXRhc2V0IiwibmFtZSIsImlubmVySFRNTCIsInBhcmVudEVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJzZWFyY2hJbnB1dCIsInZhbHVlIiwicmVuZGVyUGxhbmV0SXRlbSIsInBsYW5ldE5hbWUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwZXJzb25QbGFuZXQiLCJnZXRQZXJzb25QbGFuZXROYW1lIiwicGxhbmV0IiwicGxhbmV0SWQiLCJteVBsYW5ldCIsInBsYW5ldERhdGFMb2NhbCIsImlkIiwicGFyc2VJbnQiLCJyZXF1ZXN0U1dJbmZvIiwidXJsIiwibWV0aG9kVHlwZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwic2VuZCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJyZXNwIiwicmVzcG9uc2VUZXh0IiwicmVzcEpzb24iLCJKU09OIiwicGFyc2UiLCJjb25zb2xlIiwibG9nIiwiZXJyb3JIYW5kbGVyIiwic3RhdHVzQ29kZSIsInJlZmxlY3QiLCJwcm9taXNlIiwidGhlbiIsInJlc29sdmVkIiwicmVqZWN0ZWQiLCJnZXRQbGFuZXREYXRhIiwiX3BvcHVsYXRlTGlzdCIsInBsYW5ldE51bWJlciIsImkiLCJjdXJyZW50UGxhbmV0VVJMIiwicGxhbmV0VVJMIiwicHJvbWlzZXMiLCJwdXNoIiwiYWxsIiwibWFwIiwicGxhbmV0c0RhdGEiLCJfc3RvcmVQbGFuZXREYXRhIiwiX3NldFBsYW5ldE5hbWVUb1Blb3BsZSIsIl9zdGFydEFuaW1hdGlvbiIsInBsYW5ldERhdGEiLCJuZXdQbGFuZXQiLCJ0ZXJyYWluIiwicG9wdWxhdGlvbiIsImRpYW1ldGVyIiwicmVzaWRlbnRzIiwibGVuZ3RoIiwicmVzaWRlbnRVUkwiLCJyZXBsYWNlIiwibG9hZFNjcmVlbiIsImxvYWRHaWYiLCJsb2FkQmFsbG9vbkltZyIsInNldFRpbWVvdXQiLCJtYWluIiwiaXRlbVdyYXBwZXIiLCJlbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImRhdGEiLCJjb3VudCIsInBlb3BsZVdyYXBwZXIiLCJyZW5kZXJMaXN0IiwiX2J1aWxkTGlzdCIsInBlb3BsZU51bWJlciIsInBlb3BsZUxpQ2xvbmUiLCJwZW9wbGVMaSIsImNsb25lTm9kZSIsInBlb3BsZUdyaWQiLCJhcHBlbmRDaGlsZCIsImN1cnJlbnRQZXJzb25VUkwiLCJwZW9wbGVVUkwiLCJwZW9wbGVEYXRhIiwiX3N0b3JlUGVvcGxlRGF0YSIsInBlcnNvbkRhdGEiLCJuZXdQZXJzb24iLCJoZWlnaHQiLCJ3ZWlnaHQiLCJtYXNzIiwiYmlydGhfeWVhciIsImdlbmRlciIsImhvbWV3b3JsZCIsInNwZWNpZXMiLCJhZGRFdmVudExpc3RlbmVyIiwic2VhcmNoIiwiX2ZpbHRlck1hdGNoZXMiLCJ0ZXJtIiwibWF0Y2hGbGFnIiwicmVnZXgiLCJSZWdFeHAiLCJwZXJzb25XcmFwcGVyIiwiY2hpbGRyZW4iLCJtYXRjaCIsInNvcnRQZW9wbGUiLCJzZWN0VHlwZSIsInByb3BlcnR5Iiwic29ydCIsImEiLCJiIiwiX3NvcnRCeSJdLCJtYXBwaW5ncyI6IkFBUUEsU0FBQUEsbUJBQ0FDLGdCQUFBQyxRQUFBLFNBQUFDLEVBQUFDLEdBQ0FDLFdBQUFELEdBQUFFLFFBQUFDLEtBQUFKLEVBQUFJLEtBQ0FGLFdBQUFELEdBQUFJLFVBQUFMLEVBQUFJLEtBQ0FGLFdBQUFELEdBQUFLLGNBQUFDLFVBQUFDLElBQUEsbUNBQ0FOLFdBQUFELEdBQUFLLGNBQUFDLFVBQUFFLE9BQUEsbUNBQ0FDLFlBQUFDLE1BQUEs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RyxFQUFBSCxJQUFBLEVBQ0FFLEVBQUFGLEdBQUFHLEVBQUFILEdBQUEsRUFDQSxJQVJBSSxDQUFBTCxFQUFBMUcsT0FDQWQsbUJBQ0FlLHFCQVJBIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBsb2FkQmFsbG9vbkltZyAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubG9hZC1zY3JlZW5fX2JhbGxvb24nKTtcbnZhciBsb2FkR2lmICAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubG9hZC1zY3JlZW5fX2ltZycpO1xudmFyIHNlYXJjaElucHV0ICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX2lucHV0Jyk7XG52YXIgcGVvcGxlRGF0YUxvY2FsID0gW107XG52YXIgcGxhbmV0RGF0YUxvY2FsID0gW107XG52YXIgcGVvcGxlTmFtZTsgLy8gaG9sZCBwZW9wbGUgbGlzdCBuYW1lIERPTSBlbFxudmFyIHBlb3BsZVdyYXBwZXI7IC8vIGhvbGQgcGVvcGxlIGxpc3Qgd3JhcHBlciBET00gZWxcblxuZnVuY3Rpb24gcmVuZGVyUGVyc29uSXRlbSgpIHtcbiAgcGVvcGxlRGF0YUxvY2FsLmZvckVhY2goIGZ1bmN0aW9uKHBlcnNvbiwgaW5kZXgpIHtcbiAgICBwZW9wbGVOYW1lW2luZGV4XS5kYXRhc2V0Lm5hbWUgPSBwZXJzb24ubmFtZTtcbiAgICBwZW9wbGVOYW1lW2luZGV4XS5pbm5lckhUTUwgPSBwZXJzb24ubmFtZTtcbiAgICBwZW9wbGVOYW1lW2luZGV4XS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3Blb3BsZS1saXN0X19pdGVtLXdyYXBwZXItLXNob3cnKTtcbiAgICBwZW9wbGVOYW1lW2luZGV4XS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3Blb3BsZS1saXN0X19pdGVtLXdyYXBwZXItLWZhZGUnKTtcbiAgICBzZWFyY2hJbnB1dC52YWx1ZSA9IFwiXCI7XG5cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHJlbmRlclBsYW5ldEl0ZW0oKSB7XG4gIHZhciBwbGFuZXROYW1lICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wZW9wbGUtbGlzdF9fcGxhbmV0Jyk7XG5cbiAgcGVvcGxlRGF0YUxvY2FsLmZvckVhY2goIGZ1bmN0aW9uKHBlcnNvbiwgaW5kZXgpIHtcbiAgICB2YXIgcGVyc29uUGxhbmV0ID0gZ2V0UGVyc29uUGxhbmV0TmFtZShwZXJzb24ucGxhbmV0KTtcbiAgICBwbGFuZXROYW1lW2luZGV4XS5pbm5lckhUTUwgPSBwZXJzb25QbGFuZXQ7XG4gICAgcGxhbmV0TmFtZVtpbmRleF0uZGF0YXNldC5wbGFuZXQgPSBwZXJzb25QbGFuZXQ7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRQZXJzb25QbGFuZXROYW1lKHBsYW5ldElkKSB7XG4gIHZhciBteVBsYW5ldCA9ICcnO1xuICBwbGFuZXREYXRhTG9jYWwuZm9yRWFjaChmdW5jdGlvbihwbGFuZXQpIHtcbiAgICBpZiAocGxhbmV0LmlkID09PSBwYXJzZUludChwbGFuZXRJZCkpIHtcbiAgICAgIG15UGxhbmV0ID0gcGxhbmV0Lm5hbWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIG15UGxhbmV0O1xufVxuXG5mdW5jdGlvbiByZXF1ZXN0U1dJbmZvKHVybCwgbWV0aG9kVHlwZSl7XG4gIHZhciBwcm9taXNlT2JqID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgeGhyLm9wZW4obWV0aG9kVHlwZSwgdXJsLCB0cnVlKTtcbiAgICB4aHIuc2VuZCgpO1xuICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpe1xuICAgICAgaWYoeGhyLnJlYWR5U3RhdGUgPT09IDQpe1xuICAgICAgICAgaWYoeGhyLnN0YXR1cyA9PT0gMjAwKXtcbiAgICAgICAgICB2YXIgcmVzcCA9IHhoci5yZXNwb25zZVRleHQ7XG4gICAgICAgICAgICB2YXIgcmVzcEpzb24gPSBKU09OLnBhcnNlKHJlc3ApO1xuICAgICAgICAgICAgcmVzb2x2ZShyZXNwSnNvbik7XG4gICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICByZWplY3QoeGhyLnN0YXR1cyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInhociBmYWlsZWRcIik7IC8vIFRPRE86IGFwcGVuZCAnY2FudCBmaW5kJyBtc2dcbiAgICAgICAgICAgfVxuICAgICAgfSBlbHNle1xuICAgICAgICAgY29uc29sZS5sb2coXCJ4aHIgcHJvY2Vzc2luZyBnb2luZyBvblwiKTsgLy8gVE9ETzogYWRkIGxvYWRpbmcgYW5pbWF0aW9uXG4gICAgICAgICB9XG4gICAgfTtcbiAgfSk7XG4gIHJldHVybiBwcm9taXNlT2JqO1xufVxuXG5mdW5jdGlvbiBlcnJvckhhbmRsZXIoc3RhdHVzQ29kZSl7XG4gIGNvbnNvbGUubG9nKFwiZmFpbGVkIHdpdGggc3RhdHVzXCIsIHN0YXR1cyk7XG59XG5cbmZ1bmN0aW9uIHJlZmxlY3QocHJvbWlzZSl7XG4gIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzb2x2ZWQpeyByZXR1cm4ge3Jlc29sdmVkOnJlc29sdmVkLCBzdGF0dXM6IFwicmVzb2x2ZWRcIiB9O30sXG4gICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ocmVqZWN0ZWQpeyByZXR1cm4ge3JlamVjdGVkOnJlamVjdGVkLCBzdGF0dXM6IFwicmVqZWN0ZWRcIiB9O30pO1xufVxuIiwiZnVuY3Rpb24gZ2V0UGxhbmV0RGF0YSgpe1xuICB2YXIgaXRlbVdyYXBwZXIgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGVvcGxlLWxpc3RfX2l0ZW0td3JhcHBlcicpO1xuICB2YXIgbWFpbiAgICAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbicpO1xuICB2YXIgbG9hZFNjcmVlbiAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubG9hZC1zY3JlZW4nKTtcbiAgdmFyIHBsYW5ldFVSTCAgICAgID0gJ2h0dHBzOi8vc3dhcGkuY28vYXBpL3BsYW5ldHMvJztcbiAgdmFyIHByb21pc2VzICAgICAgID0gW107XG5cbiAgcmVxdWVzdFNXSW5mbyhwbGFuZXRVUkwsIFwiR0VUXCIpLnRoZW4oX3N0YXJ0TGlzdCwgZXJyb3JIYW5kbGVyKTtcblxuICBmdW5jdGlvbiBfc3RhcnRMaXN0KGRhdGEpIHtcbiAgICB2YXIgcGxhbmV0TnVtYmVyID0gZGF0YS5jb3VudDtcbiAgICBfcG9wdWxhdGVMaXN0KHBsYW5ldE51bWJlcik7XG4gIH1cblxuICBmdW5jdGlvbiBfcG9wdWxhdGVMaXN0KHBsYW5ldE51bWJlcikge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IHBsYW5ldE51bWJlcjsgaSsrKSB7XG4gICAgICBjdXJyZW50UGxhbmV0VVJMID0gcGxhbmV0VVJMICsgaTtcbiAgICAgIHByb21pc2VzLnB1c2gocmVxdWVzdFNXSW5mbyhjdXJyZW50UGxhbmV0VVJMLCBcIkdFVFwiKSk7XG4gICAgfVxuICAgIFByb21pc2UuYWxsKHByb21pc2VzLm1hcChyZWZsZWN0KSkudGhlbihmdW5jdGlvbihwbGFuZXRzRGF0YSl7XG4gICAgICBfc3RvcmVQbGFuZXREYXRhKHBsYW5ldHNEYXRhKTtcbiAgICAgIF9zZXRQbGFuZXROYW1lVG9QZW9wbGUoKTtcbiAgICAgIHJlbmRlclBsYW5ldEl0ZW0oKTtcbiAgICAgIF9zdGFydEFuaW1hdGlvbigpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gX3N0b3JlUGxhbmV0RGF0YShwbGFuZXRzRGF0YSkge1xuICAgIHZhciBpZCA9IDE7XG4gICAgcGxhbmV0c0RhdGEuZm9yRWFjaChmdW5jdGlvbihwbGFuZXREYXRhKSB7XG4gICAgICBpZiAocGxhbmV0RGF0YS5yZXNvbHZlZCkge1xuICAgICAgICB2YXIgbmV3UGxhbmV0ID0ge1xuICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICBuYW1lOiBwbGFuZXREYXRhLnJlc29sdmVkLm5hbWUsXG4gICAgICAgICAgdGVycmFpbjogcGxhbmV0RGF0YS5yZXNvbHZlZC50ZXJyYWluLFxuICAgICAgICAgIHBvcHVsYXRpb246IHBsYW5ldERhdGEucmVzb2x2ZWQucG9wdWxhdGlvbixcbiAgICAgICAgICBkaWFtZXRlcjogcGxhbmV0RGF0YS5yZXNvbHZlZC5kaWFtZXRlclxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChwbGFuZXREYXRhLnJlc29sdmVkLnJlc2lkZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICBuZXdQbGFuZXQucmVzaWRlbnRzID0gcGxhbmV0RGF0YS5yZXNvbHZlZC5yZXNpZGVudHMubWFwKGZ1bmN0aW9uKHJlc2lkZW50VVJMKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzaWRlbnRVUkwucmVwbGFjZSgvW14wLTldL2csJycpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld1BsYW5ldC5yZXNpZGVudHMgPSBcInVua25vd25cIjtcbiAgICAgICAgfVxuICAgICAgICBwbGFuZXREYXRhTG9jYWwucHVzaChuZXdQbGFuZXQpO1xuICAgICAgfVxuICAgICAgaWQrKztcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9zZXRQbGFuZXROYW1lVG9QZW9wbGUoKSB7XG4gICAgcGVvcGxlRGF0YUxvY2FsLmZvckVhY2goZnVuY3Rpb24ocGVyc29uKSB7XG4gICAgICBwZXJzb24ucGxhbmV0TmFtZSA9IGdldFBlcnNvblBsYW5ldE5hbWUocGVyc29uLnBsYW5ldCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBfc3RhcnRBbmltYXRpb24oKSB7XG4gICAgbG9hZFNjcmVlbi5jbGFzc0xpc3QuYWRkKCdsb2FkLXNjcmVlbi0tZmFkZW91dCcpO1xuICAgIGxvYWRHaWYuY2xhc3NMaXN0LmFkZCgnbG9hZC1zY3JlZW5fX2ltZy0tbW92ZW91dCcpO1xuICAgIGxvYWRCYWxsb29uSW1nLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWQtc2NyZWVuX19iYWxsb29uLS1zaG93Jyk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIG1haW4uY2xhc3NMaXN0LmFkZCgnbWFpbi0tc2hvdycpO1xuICAgIH0sIDEwMDApO1xuICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIGl0ZW1XcmFwcGVyLmZvckVhY2goIGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyLS1zaG93LWl0ZW1zJyk7XG4gICAgICB9KTtcbiAgICB9LCAxMjAwKTtcbiAgfVxufVxuIiwidmFyIHJlbmRlckxpc3QgPSAoZnVuY3Rpb24oKSB7XG4gIHZhciBwZW9wbGVHcmlkICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBlb3BsZS1saXN0X19ncmlkJyk7XG4gIHZhciBwZW9wbGVMaSAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBlb3BsZS1saXN0X19pdGVtJyk7XG5cbiAgdmFyIHBlb3BsZVVSTCA9ICdodHRwczovL3N3YXBpLmNvL2FwaS9wZW9wbGUvJztcbiAgdmFyIHByb21pc2VzID0gW107XG5cbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oKSB7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIGxvYWRHaWYuY2xhc3NMaXN0LmFkZCgnbG9hZC1zY3JlZW5fX2ltZy0tbW92ZWluJyk7XG4gICAgfSwgMjAwKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgbG9hZEJhbGxvb25JbWcuY2xhc3NMaXN0LmFkZCgnbG9hZC1zY3JlZW5fX2JhbGxvb24tLXNob3cnKTtcbiAgICB9LCAyMjAwKTtcbiAgfSk7XG5cbiAgcmVxdWVzdFNXSW5mbyhwZW9wbGVVUkwsIFwiR0VUXCIpLnRoZW4oX3N0YXJ0TGlzdCwgZXJyb3JIYW5kbGVyKTtcblxuICBmdW5jdGlvbiBfc3RhcnRMaXN0KGRhdGEpIHtcbiAgICB2YXIgcGVvcGxlTnVtYmVyID0gZGF0YS5jb3VudDtcbiAgICBfYnVpbGRMaXN0KHBlb3BsZU51bWJlcik7XG4gICAgX3BvcHVsYXRlTGlzdChwZW9wbGVOdW1iZXIpO1xuICB9XG5cbiAgZnVuY3Rpb24gX2J1aWxkTGlzdChwZW9wbGVOdW1iZXIpIHtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBlb3BsZU51bWJlcjsgaSs9Mikge1xuICAgICAgdmFyIHBlb3BsZUxpQ2xvbmUgPSBwZW9wbGVMaS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICBwZW9wbGVHcmlkLmFwcGVuZENoaWxkKHBlb3BsZUxpQ2xvbmUpO1xuICAgIH1cbiAgICBwZW9wbGVOYW1lICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBlb3BsZS1saXN0X19uYW1lJyk7XG4gICAgcGVvcGxlV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyJyk7XG4gIH1cblxuICBmdW5jdGlvbiBfcG9wdWxhdGVMaXN0KHBlb3BsZU51bWJlcikge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IHBlb3BsZU51bWJlcjsgaSsrKSB7XG4gICAgICBjdXJyZW50UGVyc29uVVJMID0gcGVvcGxlVVJMICsgaTtcbiAgICAgIHByb21pc2VzLnB1c2gocmVxdWVzdFNXSW5mbyhjdXJyZW50UGVyc29uVVJMLCBcIkdFVFwiKSk7XG4gICAgfVxuICAgIFByb21pc2UuYWxsKHByb21pc2VzLm1hcChyZWZsZWN0KSkudGhlbihmdW5jdGlvbihwZW9wbGVEYXRhKXtcbiAgICAgIF9zdG9yZVBlb3BsZURhdGEocGVvcGxlRGF0YSk7XG4gICAgICByZW5kZXJQZXJzb25JdGVtKCk7XG4gICAgICBnZXRQbGFuZXREYXRhKCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBfc3RvcmVQZW9wbGVEYXRhKHBlb3BsZURhdGEpIHtcbiAgICB2YXIgaWQgPSAxO1xuICAgIHBlb3BsZURhdGEuZm9yRWFjaChmdW5jdGlvbihwZXJzb25EYXRhKSB7XG4gICAgICBpZiAocGVyc29uRGF0YS5yZXNvbHZlZCkge1xuICAgICAgICB2YXIgbmV3UGVyc29uID0ge1xuICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICBuYW1lOiBwZXJzb25EYXRhLnJlc29sdmVkLm5hbWUsXG4gICAgICAgICAgaGVpZ2h0OiBwZXJzb25EYXRhLnJlc29sdmVkLmhlaWdodCxcbiAgICAgICAgICB3ZWlnaHQ6IHBlcnNvbkRhdGEucmVzb2x2ZWQubWFzcyxcbiAgICAgICAgICBiaXJ0aF95ZWFyOiBwZXJzb25EYXRhLnJlc29sdmVkLmJpcnRoX3llYXIsXG4gICAgICAgICAgZ2VuZGVyOiBwZXJzb25EYXRhLnJlc29sdmVkLmdlbmRlclxuICAgICAgICB9O1xuICAgICAgICBwZXJzb25EYXRhLnJlc29sdmVkLmhvbWV3b3JsZCA/XG4gICAgICAgIG5ld1BlcnNvbi5wbGFuZXQgPSBwZXJzb25EYXRhLnJlc29sdmVkLmhvbWV3b3JsZC5yZXBsYWNlKC9bXjAtOV0vZywnJykgOlxuICAgICAgICBuZXdQZXJzb24ucGxhbmV0ID0gXCJVbmtub3duXCI7XG5cbiAgICAgICAgcGVyc29uRGF0YS5yZXNvbHZlZC5zcGVjaWVzWzBdID9cbiAgICAgICAgbmV3UGVyc29uLnNwZWNpZXMgPSBwZXJzb25EYXRhLnJlc29sdmVkLnNwZWNpZXNbMF0ucmVwbGFjZSgvW14wLTldL2csJycpIDpcbiAgICAgICAgbmV3UGVyc29uLnNwZWNpZXMgPSBcIlVua25vd25cIjtcblxuICAgICAgICBwZW9wbGVEYXRhTG9jYWwucHVzaChuZXdQZXJzb24pO1xuICAgICAgfVxuICAgICAgaWQrKztcbiAgICB9KTtcbiAgfVxufSkoKTtcbiIsInZhciBzZWFyY2ggID0gKGZ1bmN0aW9uKCkge1xuICB2YXIgcGxhbmV0TmFtZSAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGVvcGxlLWxpc3RfX3BsYW5ldCcpO1xuXG4gIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIF9maWx0ZXJNYXRjaGVzKTtcbiAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBfZmlsdGVyTWF0Y2hlcyk7XG5cbiAgZnVuY3Rpb24gX2ZpbHRlck1hdGNoZXMoKSB7XG4gICAgdGVybSA9IHNlYXJjaElucHV0LnZhbHVlO1xuICAgIHZhciBtYXRjaEZsYWcgPSAwO1xuICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAodGVybSwgJ2dpJyk7XG4gICAgcGVvcGxlV3JhcHBlci5mb3JFYWNoKGZ1bmN0aW9uKHBlcnNvbldyYXBwZXIpIHtcbiAgICAgIGlmKHBlcnNvbldyYXBwZXIuY2hpbGRyZW5bMF0uZGF0YXNldC5uYW1lKSB7XG4gICAgICAgIGlmIChwZXJzb25XcmFwcGVyLmNoaWxkcmVuWzBdLmRhdGFzZXQubmFtZS5tYXRjaChyZWdleCkgfHwgcGVyc29uV3JhcHBlci5jaGlsZHJlblsxXS5kYXRhc2V0LnBsYW5ldC5tYXRjaChyZWdleCkpIHtcbiAgICAgICAgICBtYXRjaEZsYWcrKztcbiAgICAgICAgICAgIHBlcnNvbldyYXBwZXIuY2xhc3NMaXN0LmFkZCgncGVvcGxlLWxpc3RfX2l0ZW0td3JhcHBlci0tc2hvdycpO1xuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcGVyc29uV3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdwZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyLS1mYWRlJyk7XG4gICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcGVyc29uV3JhcHBlci5jbGFzc0xpc3QuYWRkKCdwZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyLS1mYWRlJyk7XG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcGVyc29uV3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdwZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyLS1zaG93Jyk7XG4gICAgICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIG1hdGNoRmxhZyA9PT0gMCA/IHNlYXJjaElucHV0LmNsYXNzTGlzdC5hZGQoJ2hlYWRlcl9faW5wdXQtLW5vLXJlc3VsdHMnKSA6IHNlYXJjaElucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ2hlYWRlcl9faW5wdXQtLW5vLXJlc3VsdHMnKVxuICB9XG59KSgpO1xuIiwidmFyIHNvcnRQZW9wbGUgPSAoZnVuY3Rpb24oKSB7XG4gIHZhciBzZWN0VHlwZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX3NlbGVjdCcpO1xuXG4gIHNlY3RUeXBlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIF9zb3J0UGVvcGxlRGF0YUxvY2FsKTtcblxuICBmdW5jdGlvbiBfc29ydFBlb3BsZURhdGFMb2NhbCgpIHtcbiAgICBfc29ydEJ5KHNlY3RUeXBlLnZhbHVlKTtcbiAgICByZW5kZXJQZXJzb25JdGVtKCk7XG4gICAgcmVuZGVyUGxhbmV0SXRlbSgpO1xuXG4gICAgZnVuY3Rpb24gX3NvcnRCeShwcm9wZXJ0eSkge1xuICAgICAgcGVvcGxlRGF0YUxvY2FsLnNvcnQoZnVuY3Rpb24oYSwgYil7XG4gICAgICAgIGlmKGFbcHJvcGVydHldIDwgYltwcm9wZXJ0eV0pIHJldHVybiAtMTtcbiAgICAgICAgaWYoYVtwcm9wZXJ0eV0gPiBiW3Byb3BlcnR5XSkgcmV0dXJuIDE7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpO1xuXG4iXX0=
