function renderPersonItem(){peopleDataLocal.forEach(function(e,t){peopleName[t].dataset.name=e.name,peopleName[t].innerHTML=e.name,peopleName[t].parentElement.classList.add("people-list__item-wrapper--show")})}function renderPlanetItem(){var e=document.querySelectorAll(".people-list__planet");peopleDataLocal.forEach(function(t,n){var r=getPersonPlanetName(t.planet);e[n].innerHTML=r,e[n].dataset.planet=r})}function getPersonPlanetName(e){var t="";return planetDataLocal.forEach(function(n){n.id!==parseInt(e)||(t=n.name)}),t}function requestSWInfo(e,t){return new Promise(function(n,r){var a=new XMLHttpRequest;a.open(t,e,!0),a.send(),a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status){var e=a.responseText,t=JSON.parse(e);n(t)}else r(a.status)}})}function errorHandler(e){console.log("failed with status",status)}function reflect(e){return e.then(function(e){return{resolved:e,status:"resolved"}},function(e){return{rejected:e,status:"rejected"}})}function getPlanetData(){function e(e){for(var a=1;a<=e;a++)currentPlanetURL=c+a,i.push(requestSWInfo(currentPlanetURL,"GET"));Promise.all(i.map(reflect)).then(function(e){t(e),n(),renderPlanetItem(),r()})}function t(e){var t=1;e.forEach(function(e){if(e.resolved){var n={id:t,name:e.resolved.name,terrain:e.resolved.terrain,population:e.resolved.population,diameter:e.resolved.diameter};e.resolved.residents.length?n.residents=e.resolved.residents.map(function(e){return e.replace(/[^0-9]/g,"")}):n.residents="unknown",planetDataLocal.push(n)}t++})}function n(){peopleDataLocal.forEach(function(e){e.planetName=getPersonPlanetName(e.planet)})}function r(){l.classList.add("load-screen--fadeout"),s.classList.add("load-screen__img--moveout"),setTimeout(function(){o.classList.add("main--show")},1e3),setTimeout(function(){a.forEach(function(e){e.classList.add("people-list__item-wrapper--show-items")})},1200)}var a=document.querySelectorAll(".people-list__item-wrapper"),o=document.querySelector(".main"),l=document.querySelector(".load-screen"),s=document.querySelector(".load-screen__img"),c="https://swapi.co/api/planets/",i=[];requestSWInfo(c,"GET").then(function(t){e(t.count)},errorHandler)}var peopleDataLocal=[],planetDataLocal=[],peopleName,peopleWrapper,renderList=function(){function e(e){for(var t=1;t<e;t+=2){var n=a.cloneNode(!0);r.appendChild(n)}peopleName=document.querySelectorAll(".people-list__name"),peopleWrapper=document.querySelectorAll(".people-list__item-wrapper")}function t(e){for(var t=1;t<=e;t++)currentPersonURL=o+t,l.push(requestSWInfo(currentPersonURL,"GET"));Promise.all(l.map(reflect)).then(function(e){n(e),renderPersonItem(),getPlanetData()})}function n(e){var t=1;e.forEach(function(e){if(e.resolved){var n={id:t,name:e.resolved.name,height:e.resolved.height,weight:e.resolved.mass,birth_year:e.resolved.birth_year,gender:e.resolved.gender};e.resolved.homeworld?n.planet=e.resolved.homeworld.replace(/[^0-9]/g,""):n.planet="Unknown",e.resolved.species[0]?n.species=e.resolved.species[0].replace(/[^0-9]/g,""):n.species="Unknown",peopleDataLocal.push(n)}t++})}var r=document.querySelector(".people-list__grid"),a=document.querySelector(".people-list__item"),o="https://swapi.co/api/people/",l=[];requestSWInfo(o,"GET").then(function(n){var r=n.count;e(r),t(r)},errorHandler)}(),search=function(){function e(){term=t.value;var e=0,n=new RegExp(term,"gi");peopleWrapper.forEach(function(t){t.children[0].dataset.name&&(t.children[0].dataset.name.match(n)||t.children[1].dataset.planet.match(n)?(e++,t.classList.add("people-list__item-wrapper--show")):t.classList.remove("people-list__item-wrapper--show"))}),0===e?t.classList.add("header__input--no-results"):t.classList.remove("header__input--no-results")}var t=document.querySelector(".header__input");document.querySelectorAll(".people-list__planet");t.addEventListener("change",e),t.addEventListener("keyup",e)}(),sortPeople=function(){var e=document.querySelector(".header__select");e.addEventListener("change",function(){!function(e){peopleDataLocal.sort(function(t,n){return t[e]<n[e]?-1:t[e]>n[e]?1:0})}(e.value),renderPersonItem(),renderPlanetItem()})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9tYWluLmpzIiwicGxhbmV0LWxpc3QuanMiLCJwZW9wbGUtbGlzdC5qcyIsInNlYXJjaC5qcyIsInNvcnRQZW9wbGUuanMiXSwibmFtZXMiOlsicmVuZGVyUGVyc29uSXRlbSIsInBlb3BsZURhdGFMb2NhbCIsImZvckVhY2giLCJwZXJzb24iLCJpbmRleCIsInBlb3BsZU5hbWUiLCJkYXRhc2V0IiwibmFtZSIsImlubmVySFRNTCIsInBhcmVudEVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW5kZXJQbGFuZXRJdGVtIiwicGxhbmV0TmFtZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsInBlcnNvblBsYW5ldCIsImdldFBlcnNvblBsYW5ldE5hbWUiLCJwbGFuZXQiLCJwbGFuZXRJZCIsIm15UGxhbmV0IiwicGxhbmV0RGF0YUxvY2FsIiwiaWQiLCJwYXJzZUludCIsInJlcXVlc3RTV0luZm8iLCJ1cmwiLCJtZXRob2RUeXBlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJzZW5kIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsInJlc3AiLCJyZXNwb25zZVRleHQiLCJyZXNwSnNvbiIsIkpTT04iLCJwYXJzZSIsImVycm9ySGFuZGxlciIsInN0YXR1c0NvZGUiLCJjb25zb2xlIiwibG9nIiwicmVmbGVjdCIsInByb21pc2UiLCJ0aGVuIiwicmVzb2x2ZWQiLCJyZWplY3RlZCIsImdldFBsYW5ldERhdGEiLCJfcG9wdWxhdGVMaXN0IiwicGxhbmV0TnVtYmVyIiwiaSIsImN1cnJlbnRQbGFuZXRVUkwiLCJwbGFuZXRVUkwiLCJwcm9taXNlcyIsInB1c2giLCJhbGwiLCJtYXAiLCJwbGFuZXRzRGF0YSIsIl9zdG9yZVBsYW5ldERhdGEiLCJfc2V0UGxhbmV0TmFtZVRvUGVvcGxlIiwiX3N0YXJ0QW5pbWF0aW9uIiwicGxhbmV0RGF0YSIsIm5ld1BsYW5ldCIsInRlcnJhaW4iLCJwb3B1bGF0aW9uIiwiZGlhbWV0ZXIiLCJyZXNpZGVudHMiLCJsZW5ndGgiLCJyZXNpZGVudFVSTCIsInJlcGxhY2UiLCJsb2FkU2NyZWVuIiwibG9hZEdpZiIsInNldFRpbWVvdXQiLCJtYWluIiwiaXRlbVdyYXBwZXIiLCJlbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImRhdGEiLCJjb3VudCIsInBlb3BsZVdyYXBwZXIiLCJyZW5kZXJMaXN0IiwiX2J1aWxkTGlzdCIsInBlb3BsZU51bWJlciIsInBlb3BsZUxpQ2xvbmUiLCJwZW9wbGVMaSIsImNsb25lTm9kZSIsInBlb3BsZUdyaWQiLCJhcHBlbmRDaGlsZCIsImN1cnJlbnRQZXJzb25VUkwiLCJwZW9wbGVVUkwiLCJwZW9wbGVEYXRhIiwiX3N0b3JlUGVvcGxlRGF0YSIsInBlcnNvbkRhdGEiLCJuZXdQZXJzb24iLCJoZWlnaHQiLCJ3ZWlnaHQiLCJtYXNzIiwiYmlydGhfeWVhciIsImdlbmRlciIsImhvbWV3b3JsZCIsInNwZWNpZXMiLCJzZWFyY2giLCJfZmlsdGVyTWF0Y2hlcyIsInRlcm0iLCJzZWFyY2hJbnB1dCIsInZhbHVlIiwibWF0Y2hGbGFnIiwicmVnZXgiLCJSZWdFeHAiLCJwZXJzb25XcmFwcGVyIiwiY2hpbGRyZW4iLCJtYXRjaCIsInJlbW92ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzb3J0UGVvcGxlIiwic2VjdFR5cGUiLCJwcm9wZXJ0eSIsInNvcnQiLCJhIiwiYiIsIl9zb3J0QnkiXSwibWFwcGluZ3MiOiJBQUtBLFNBQUFBLG1CQUNBQyxnQkFBQUMsUUFBQSxTQUFBQyxFQUFBQyxHQUNBQyxXQUFBRCxHQUFBRSxRQUFBQyxLQUFBSixFQUFBSSxLQUNBRixXQUFBRCxHQUFBSSxVQUFBTCxFQUFBSSxLQUNBRixXQUFBRCxHQUFBSyxjQUFBQyxVQUFBQyxJQUFBLHFDQUlBLFNBQUFDLG1CQUNBLElBQUFDLEVBQUFDLFNBQUFDLGlCQUFBLHdCQUVBZCxnQkFBQUMsUUFBQSxTQUFBQyxFQUFB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LElBQUFDLEVBQUEsRUFDQUMsRUFBQSxJQUFBQyxPQUFBTCxLQUFBLE1BQ0F4QixjQUFBakYsUUFBQSxTQUFBK0csR0FDQUEsRUFBQUMsU0FBQSxHQUFBNUcsUUFBQUMsT0FDQTBHLEVBQUFDLFNBQUEsR0FBQTVHLFFBQUFDLEtBQUE0RyxNQUFBSixJQUFBRSxFQUFBQyxTQUFBLEdBQUE1RyxRQUFBWSxPQUFBaUcsTUFBQUosSUFDQUQsSUFDQUcsRUFBQXZHLFVBQUFDLElBQUEsb0NBRUFzRyxFQUFBdkcsVUFBQTBHLE9BQUEsc0NBSUEsSUFBQU4sRUFBQUYsRUFBQWxHLFVBQUFDLElBQUEsNkJBQUFpRyxFQUFBbEcsVUFBQTBHLE9BQUEsNkJBcEJBLElBQUFSLEVBQUE5RixTQUFBa0UsY0FBQSxrQkFDQWxFLFNBQUFDLGlCQUFBLHdCQUVBNkYsRUFBQVMsaUJBQUEsU0FBQVgsR0FDQUUsRUFBQVMsaUJBQUEsUUFBQVgsR0FMQSxHQ0FBWSxXQUFBLFdBQ0EsSUFBQUMsRUFBQXpHLFNBQUFrRSxjQUFBLG1CQUVBdUMsRUFBQUYsaUJBQUEsU0FFQSxZQUtBLFNBQUFHLEdBQ0F2SCxnQkFBQXdILEtBQUEsU0FBQUMsRUFBQUMsR0FDQSxPQUFBRCxFQUFBRixHQUFBRyxFQUFBSCxJQUFBLEVBQ0FFLEVBQUFGLEdBQUFHLEVBQUFILEdBQUEsRUFDQSxJQVJBSSxDQUFBTCxFQUFBVixPQUNBN0csbUJBQ0FZLHFCQVJBIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBwZW9wbGVEYXRhTG9jYWwgPSBbXTtcbnZhciBwbGFuZXREYXRhTG9jYWwgPSBbXTtcbnZhciBwZW9wbGVOYW1lOyAvLyBob2xkIHBlb3BsZSBsaXN0IG5hbWUgRE9NIGVsXG52YXIgcGVvcGxlV3JhcHBlcjsgLy8gaG9sZCBwZW9wbGUgbGlzdCB3cmFwcGVyIERPTSBlbFxuXG5mdW5jdGlvbiByZW5kZXJQZXJzb25JdGVtKCkge1xuICBwZW9wbGVEYXRhTG9jYWwuZm9yRWFjaCggZnVuY3Rpb24ocGVyc29uLCBpbmRleCkge1xuICAgIHBlb3BsZU5hbWVbaW5kZXhdLmRhdGFzZXQubmFtZSA9IHBlcnNvbi5uYW1lO1xuICAgIHBlb3BsZU5hbWVbaW5kZXhdLmlubmVySFRNTCA9IHBlcnNvbi5uYW1lO1xuICAgIHBlb3BsZU5hbWVbaW5kZXhdLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncGVvcGxlLWxpc3RfX2l0ZW0td3JhcHBlci0tc2hvdycpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcmVuZGVyUGxhbmV0SXRlbSgpIHtcbiAgdmFyIHBsYW5ldE5hbWUgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBlb3BsZS1saXN0X19wbGFuZXQnKTtcblxuICBwZW9wbGVEYXRhTG9jYWwuZm9yRWFjaCggZnVuY3Rpb24ocGVyc29uLCBpbmRleCkge1xuICAgIHZhciBwZXJzb25QbGFuZXQgPSBnZXRQZXJzb25QbGFuZXROYW1lKHBlcnNvbi5wbGFuZXQpO1xuICAgIHBsYW5ldE5hbWVbaW5kZXhdLmlubmVySFRNTCA9IHBlcnNvblBsYW5ldDtcbiAgICBwbGFuZXROYW1lW2luZGV4XS5kYXRhc2V0LnBsYW5ldCA9IHBlcnNvblBsYW5ldDtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldFBlcnNvblBsYW5ldE5hbWUocGxhbmV0SWQpIHtcbiAgdmFyIG15UGxhbmV0ID0gJyc7XG4gIHBsYW5ldERhdGFMb2NhbC5mb3JFYWNoKGZ1bmN0aW9uKHBsYW5ldCkge1xuICAgIGlmIChwbGFuZXQuaWQgPT09IHBhcnNlSW50KHBsYW5ldElkKSkge1xuICAgICAgbXlQbGFuZXQgPSBwbGFuZXQubmFtZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gbXlQbGFuZXQ7XG59XG5cbmZ1bmN0aW9uIHJlcXVlc3RTV0luZm8odXJsLCBtZXRob2RUeXBlKXtcbiAgdmFyIHByb21pc2VPYmogPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICB4aHIub3BlbihtZXRob2RUeXBlLCB1cmwsIHRydWUpO1xuICAgIHhoci5zZW5kKCk7XG4gICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCl7XG4gICAgICBpZih4aHIucmVhZHlTdGF0ZSA9PT0gNCl7XG4gICAgICAgICBpZih4aHIuc3RhdHVzID09PSAyMDApe1xuICAgICAgICAgIHZhciByZXNwID0geGhyLnJlc3BvbnNlVGV4dDtcbiAgICAgICAgICAgIHZhciByZXNwSnNvbiA9IEpTT04ucGFyc2UocmVzcCk7XG4gICAgICAgICAgICByZXNvbHZlKHJlc3BKc29uKTtcbiAgICAgICAgIH0gZWxzZXtcbiAgICAgICAgICAgIHJlamVjdCh4aHIuc3RhdHVzKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwieGhyIGZhaWxlZFwiKTsgLy8gVE9ETzogYXBwZW5kICdjYW50IGZpbmQnIG1zZ1xuICAgICAgICAgICB9XG4gICAgICB9IGVsc2V7XG4gICAgICAgICAvLyBjb25zb2xlLmxvZyhcInhociBwcm9jZXNzaW5nIGdvaW5nIG9uXCIpOyAvLyBUT0RPOiBhZGQgbG9hZGluZyBhbmltYXRpb25cbiAgICAgICAgIH1cbiAgICB9O1xuICB9KTtcbiAgcmV0dXJuIHByb21pc2VPYmo7XG59XG5cbmZ1bmN0aW9uIGVycm9ySGFuZGxlcihzdGF0dXNDb2RlKXtcbiAgY29uc29sZS5sb2coXCJmYWlsZWQgd2l0aCBzdGF0dXNcIiwgc3RhdHVzKTtcbn1cblxuZnVuY3Rpb24gcmVmbGVjdChwcm9taXNlKXtcbiAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbihyZXNvbHZlZCl7IHJldHVybiB7cmVzb2x2ZWQ6cmVzb2x2ZWQsIHN0YXR1czogXCJyZXNvbHZlZFwiIH07fSxcbiAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihyZWplY3RlZCl7IHJldHVybiB7cmVqZWN0ZWQ6cmVqZWN0ZWQsIHN0YXR1czogXCJyZWplY3RlZFwiIH07fSk7XG59XG4iLCJmdW5jdGlvbiBnZXRQbGFuZXREYXRhKCl7XG4gIHZhciBpdGVtV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyJyk7XG4gIHZhciBtYWluICAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYWluJyk7XG4gIHZhciBsb2FkU2NyZWVuICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5sb2FkLXNjcmVlbicpO1xuICB2YXIgbG9hZEdpZiAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubG9hZC1zY3JlZW5fX2ltZycpO1xuICB2YXIgcGxhbmV0VVJMICAgPSAnaHR0cHM6Ly9zd2FwaS5jby9hcGkvcGxhbmV0cy8nO1xuICB2YXIgcHJvbWlzZXMgICAgPSBbXTtcblxuICByZXF1ZXN0U1dJbmZvKHBsYW5ldFVSTCwgXCJHRVRcIikudGhlbihfc3RhcnRMaXN0LCBlcnJvckhhbmRsZXIpO1xuXG4gIGZ1bmN0aW9uIF9zdGFydExpc3QoZGF0YSkge1xuICAgIHZhciBwbGFuZXROdW1iZXIgPSBkYXRhLmNvdW50O1xuICAgIF9wb3B1bGF0ZUxpc3QocGxhbmV0TnVtYmVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9wb3B1bGF0ZUxpc3QocGxhbmV0TnVtYmVyKSB7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gcGxhbmV0TnVtYmVyOyBpKyspIHtcbiAgICAgIGN1cnJlbnRQbGFuZXRVUkwgPSBwbGFuZXRVUkwgKyBpO1xuICAgICAgcHJvbWlzZXMucHVzaChyZXF1ZXN0U1dJbmZvKGN1cnJlbnRQbGFuZXRVUkwsIFwiR0VUXCIpKTtcbiAgICB9XG4gICAgUHJvbWlzZS5hbGwocHJvbWlzZXMubWFwKHJlZmxlY3QpKS50aGVuKGZ1bmN0aW9uKHBsYW5ldHNEYXRhKXtcbiAgICAgIF9zdG9yZVBsYW5ldERhdGEocGxhbmV0c0RhdGEpO1xuICAgICAgX3NldFBsYW5ldE5hbWVUb1Blb3BsZSgpO1xuICAgICAgcmVuZGVyUGxhbmV0SXRlbSgpO1xuICAgICAgX3N0YXJ0QW5pbWF0aW9uKCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBfc3RvcmVQbGFuZXREYXRhKHBsYW5ldHNEYXRhKSB7XG4gICAgdmFyIGlkID0gMTtcbiAgICBwbGFuZXRzRGF0YS5mb3JFYWNoKGZ1bmN0aW9uKHBsYW5ldERhdGEpIHtcbiAgICAgIGlmIChwbGFuZXREYXRhLnJlc29sdmVkKSB7XG4gICAgICAgIHZhciBuZXdQbGFuZXQgPSB7XG4gICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgIG5hbWU6IHBsYW5ldERhdGEucmVzb2x2ZWQubmFtZSxcbiAgICAgICAgICB0ZXJyYWluOiBwbGFuZXREYXRhLnJlc29sdmVkLnRlcnJhaW4sXG4gICAgICAgICAgcG9wdWxhdGlvbjogcGxhbmV0RGF0YS5yZXNvbHZlZC5wb3B1bGF0aW9uLFxuICAgICAgICAgIGRpYW1ldGVyOiBwbGFuZXREYXRhLnJlc29sdmVkLmRpYW1ldGVyXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHBsYW5ldERhdGEucmVzb2x2ZWQucmVzaWRlbnRzLmxlbmd0aCkge1xuICAgICAgICAgIG5ld1BsYW5ldC5yZXNpZGVudHMgPSBwbGFuZXREYXRhLnJlc29sdmVkLnJlc2lkZW50cy5tYXAoZnVuY3Rpb24ocmVzaWRlbnRVUkwpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNpZGVudFVSTC5yZXBsYWNlKC9bXjAtOV0vZywnJyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3UGxhbmV0LnJlc2lkZW50cyA9IFwidW5rbm93blwiO1xuICAgICAgICB9XG4gICAgICAgIHBsYW5ldERhdGFMb2NhbC5wdXNoKG5ld1BsYW5ldCk7XG4gICAgICB9XG4gICAgICBpZCsrO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gX3NldFBsYW5ldE5hbWVUb1Blb3BsZSgpIHtcbiAgICBwZW9wbGVEYXRhTG9jYWwuZm9yRWFjaChmdW5jdGlvbihwZXJzb24pIHtcbiAgICAgIHBlcnNvbi5wbGFuZXROYW1lID0gZ2V0UGVyc29uUGxhbmV0TmFtZShwZXJzb24ucGxhbmV0KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9zdGFydEFuaW1hdGlvbigpIHtcbiAgICBsb2FkU2NyZWVuLmNsYXNzTGlzdC5hZGQoJ2xvYWQtc2NyZWVuLS1mYWRlb3V0Jyk7XG4gICAgbG9hZEdpZi5jbGFzc0xpc3QuYWRkKCdsb2FkLXNjcmVlbl9faW1nLS1tb3Zlb3V0Jyk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIG1haW4uY2xhc3NMaXN0LmFkZCgnbWFpbi0tc2hvdycpO1xuICAgIH0sIDEwMDApO1xuICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIGl0ZW1XcmFwcGVyLmZvckVhY2goIGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyLS1zaG93LWl0ZW1zJyk7XG4gICAgICB9KTtcbiAgICB9LCAxMjAwKTtcbiAgfVxufVxuIiwidmFyIHJlbmRlckxpc3QgPSAoZnVuY3Rpb24oKSB7XG4gIHZhciBwZW9wbGVHcmlkICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBlb3BsZS1saXN0X19ncmlkJyk7XG4gIHZhciBwZW9wbGVMaSAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBlb3BsZS1saXN0X19pdGVtJyk7XG5cbiAgdmFyIHBlb3BsZVVSTCA9ICdodHRwczovL3N3YXBpLmNvL2FwaS9wZW9wbGUvJztcbiAgdmFyIHByb21pc2VzID0gW107XG5cbiAgcmVxdWVzdFNXSW5mbyhwZW9wbGVVUkwsIFwiR0VUXCIpLnRoZW4oX3N0YXJ0TGlzdCwgZXJyb3JIYW5kbGVyKTtcblxuICBmdW5jdGlvbiBfc3RhcnRMaXN0KGRhdGEpIHtcbiAgICB2YXIgcGVvcGxlTnVtYmVyID0gZGF0YS5jb3VudDtcbiAgICBfYnVpbGRMaXN0KHBlb3BsZU51bWJlcik7XG4gICAgX3BvcHVsYXRlTGlzdChwZW9wbGVOdW1iZXIpO1xuICB9XG5cbiAgZnVuY3Rpb24gX2J1aWxkTGlzdChwZW9wbGVOdW1iZXIpIHtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBlb3BsZU51bWJlcjsgaSs9Mikge1xuICAgICAgdmFyIHBlb3BsZUxpQ2xvbmUgPSBwZW9wbGVMaS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICBwZW9wbGVHcmlkLmFwcGVuZENoaWxkKHBlb3BsZUxpQ2xvbmUpO1xuICAgIH1cbiAgICBwZW9wbGVOYW1lICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBlb3BsZS1saXN0X19uYW1lJyk7XG4gICAgcGVvcGxlV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyJyk7XG4gIH1cblxuICBmdW5jdGlvbiBfcG9wdWxhdGVMaXN0KHBlb3BsZU51bWJlcikge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IHBlb3BsZU51bWJlcjsgaSsrKSB7XG4gICAgICBjdXJyZW50UGVyc29uVVJMID0gcGVvcGxlVVJMICsgaTtcbiAgICAgIHByb21pc2VzLnB1c2gocmVxdWVzdFNXSW5mbyhjdXJyZW50UGVyc29uVVJMLCBcIkdFVFwiKSk7XG4gICAgfVxuICAgIFByb21pc2UuYWxsKHByb21pc2VzLm1hcChyZWZsZWN0KSkudGhlbihmdW5jdGlvbihwZW9wbGVEYXRhKXtcbiAgICAgIF9zdG9yZVBlb3BsZURhdGEocGVvcGxlRGF0YSk7XG4gICAgICByZW5kZXJQZXJzb25JdGVtKCk7XG4gICAgICBnZXRQbGFuZXREYXRhKCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBfc3RvcmVQZW9wbGVEYXRhKHBlb3BsZURhdGEpIHtcbiAgICB2YXIgaWQgPSAxO1xuICAgIHBlb3BsZURhdGEuZm9yRWFjaChmdW5jdGlvbihwZXJzb25EYXRhKSB7XG4gICAgICBpZiAocGVyc29uRGF0YS5yZXNvbHZlZCkge1xuICAgICAgICB2YXIgbmV3UGVyc29uID0ge1xuICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICBuYW1lOiBwZXJzb25EYXRhLnJlc29sdmVkLm5hbWUsXG4gICAgICAgICAgaGVpZ2h0OiBwZXJzb25EYXRhLnJlc29sdmVkLmhlaWdodCxcbiAgICAgICAgICB3ZWlnaHQ6IHBlcnNvbkRhdGEucmVzb2x2ZWQubWFzcyxcbiAgICAgICAgICBiaXJ0aF95ZWFyOiBwZXJzb25EYXRhLnJlc29sdmVkLmJpcnRoX3llYXIsXG4gICAgICAgICAgZ2VuZGVyOiBwZXJzb25EYXRhLnJlc29sdmVkLmdlbmRlclxuICAgICAgICB9O1xuICAgICAgICBwZXJzb25EYXRhLnJlc29sdmVkLmhvbWV3b3JsZCA/XG4gICAgICAgIG5ld1BlcnNvbi5wbGFuZXQgPSBwZXJzb25EYXRhLnJlc29sdmVkLmhvbWV3b3JsZC5yZXBsYWNlKC9bXjAtOV0vZywnJykgOlxuICAgICAgICBuZXdQZXJzb24ucGxhbmV0ID0gXCJVbmtub3duXCI7XG5cbiAgICAgICAgcGVyc29uRGF0YS5yZXNvbHZlZC5zcGVjaWVzWzBdID9cbiAgICAgICAgbmV3UGVyc29uLnNwZWNpZXMgPSBwZXJzb25EYXRhLnJlc29sdmVkLnNwZWNpZXNbMF0ucmVwbGFjZSgvW14wLTldL2csJycpIDpcbiAgICAgICAgbmV3UGVyc29uLnNwZWNpZXMgPSBcIlVua25vd25cIjtcblxuICAgICAgICBwZW9wbGVEYXRhTG9jYWwucHVzaChuZXdQZXJzb24pO1xuICAgICAgfVxuICAgICAgaWQrKztcbiAgICB9KTtcbiAgfVxufSkoKTtcbiIsInZhciBzZWFyY2ggID0gKGZ1bmN0aW9uKCkge1xuICB2YXIgc2VhcmNoSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX19pbnB1dCcpO1xuICB2YXIgcGxhbmV0TmFtZSAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGVvcGxlLWxpc3RfX3BsYW5ldCcpO1xuXG4gIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIF9maWx0ZXJNYXRjaGVzKTtcbiAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBfZmlsdGVyTWF0Y2hlcyk7XG5cbiAgZnVuY3Rpb24gX2ZpbHRlck1hdGNoZXMoKSB7XG4gICAgdGVybSA9IHNlYXJjaElucHV0LnZhbHVlO1xuICAgIHZhciBtYXRjaEZsYWcgPSAwO1xuICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAodGVybSwgJ2dpJyk7XG4gICAgcGVvcGxlV3JhcHBlci5mb3JFYWNoKGZ1bmN0aW9uKHBlcnNvbldyYXBwZXIpIHtcbiAgICAgIGlmKHBlcnNvbldyYXBwZXIuY2hpbGRyZW5bMF0uZGF0YXNldC5uYW1lKSB7XG4gICAgICAgIGlmIChwZXJzb25XcmFwcGVyLmNoaWxkcmVuWzBdLmRhdGFzZXQubmFtZS5tYXRjaChyZWdleCkgfHwgcGVyc29uV3JhcHBlci5jaGlsZHJlblsxXS5kYXRhc2V0LnBsYW5ldC5tYXRjaChyZWdleCkpIHtcbiAgICAgICAgICBtYXRjaEZsYWcrKztcbiAgICAgICAgICBwZXJzb25XcmFwcGVyLmNsYXNzTGlzdC5hZGQoJ3Blb3BsZS1saXN0X19pdGVtLXdyYXBwZXItLXNob3cnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwZXJzb25XcmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Blb3BsZS1saXN0X19pdGVtLXdyYXBwZXItLXNob3cnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIG1hdGNoRmxhZyA9PT0gMCA/IHNlYXJjaElucHV0LmNsYXNzTGlzdC5hZGQoJ2hlYWRlcl9faW5wdXQtLW5vLXJlc3VsdHMnKSA6IHNlYXJjaElucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ2hlYWRlcl9faW5wdXQtLW5vLXJlc3VsdHMnKVxuICB9XG59KSgpO1xuIiwidmFyIHNvcnRQZW9wbGUgPSAoZnVuY3Rpb24oKSB7XG4gIHZhciBzZWN0VHlwZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX3NlbGVjdCcpO1xuXG4gIHNlY3RUeXBlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIF9zb3J0UGVvcGxlRGF0YUxvY2FsKTtcblxuICBmdW5jdGlvbiBfc29ydFBlb3BsZURhdGFMb2NhbCgpIHtcbiAgICBfc29ydEJ5KHNlY3RUeXBlLnZhbHVlKTtcbiAgICByZW5kZXJQZXJzb25JdGVtKCk7XG4gICAgcmVuZGVyUGxhbmV0SXRlbSgpO1xuXG4gICAgZnVuY3Rpb24gX3NvcnRCeShwcm9wZXJ0eSkge1xuICAgICAgcGVvcGxlRGF0YUxvY2FsLnNvcnQoZnVuY3Rpb24oYSwgYil7XG4gICAgICAgIGlmKGFbcHJvcGVydHldIDwgYltwcm9wZXJ0eV0pIHJldHVybiAtMTtcbiAgICAgICAgaWYoYVtwcm9wZXJ0eV0gPiBiW3Byb3BlcnR5XSkgcmV0dXJuIDE7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KSgpO1xuXG4iXX0=
