function requestSWInfo(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;o.open(t,e,!0),o.send(),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){var e=o.responseText,t=JSON.parse(e);n(t)}else r(o.status)}})}function errorHandler(e){console.log("failed with status",status)}function reflect(e){return e.then(function(e){return{resolved:e,status:"resolved"}},function(e){return{rejected:e,status:"rejected"}})}function getPlanetData(){function e(e){for(var r=1;r<=e;r++)currentPlanetURL=p+r,u.push(requestSWInfo(currentPlanetURL,"GET"));Promise.all(u.map(reflect)).then(function(e){t(e),n(),o()})}function t(e){var t=1;e.forEach(function(e){if(e.resolved){var n={id:t,name:e.resolved.name,terrain:e.resolved.terrain,population:e.resolved.population,diameter:e.resolved.diameter};e.resolved.residents.length?n.residents=e.resolved.residents.map(function(e){return e.replace(/[^0-9]/g,"")}):n.residents="unknown",planetDataLocal.push(n)}t++})}function n(){peopleDataLocal.forEach(function(e,t){var n=r(e.planet);a[t].innerHTML=n,a[t].dataset.planet=n})}function r(e){var t="";return planetDataLocal.forEach(function(n){n.id!==parseInt(e)||(t=n.name)}),t}function o(){i.classList.add("load-screen--fadeout"),c.classList.add("load-screen__img--moveout"),setTimeout(function(){s.classList.add("main--show")},1e3),setTimeout(function(){l.forEach(function(e){e.classList.add("people-list__item-wrapper--show-items")})},1200)}var a=document.querySelectorAll(".people-list__planet"),l=document.querySelectorAll(".people-list__item-wrapper"),s=document.querySelector(".main"),i=document.querySelector(".load-screen"),c=document.querySelector(".load-screen__img"),p="https://swapi.co/api/planets/",u=[];requestSWInfo(p,"GET").then(function(t){e(t.count)},errorHandler)}var peopleDataLocal=[],planetDataLocal=[],renderList=function(){function e(e){for(var t=1;t<e;t+=2){var n=a.cloneNode(!0);o.appendChild(n)}peopleName=document.querySelectorAll(".people-list__name")}function t(e){for(var t=1;t<=e;t++)currentPersonURL=l+t,s.push(requestSWInfo(currentPersonURL,"GET"));Promise.all(s.map(reflect)).then(function(e){n(e),r(),getPlanetData()})}function n(e){var t=1;e.forEach(function(e){if(e.resolved){var n={id:t,name:e.resolved.name,height:e.resolved.height,weight:e.resolved.mass,birth_year:e.resolved.birth_year,gender:e.resolved.gender};e.resolved.homeworld?n.planet=e.resolved.homeworld.replace(/[^0-9]/g,""):n.planet="unknown",e.resolved.species[0]?n.species=e.resolved.species[0].replace(/[^0-9]/g,""):n.species="unknown",peopleDataLocal.push(n)}t++})}function r(){peopleDataLocal.forEach(function(e,t){peopleName[t].dataset.name=e.name,peopleName[t].innerHTML=e.name,peopleName[t].parentElement.classList.add("people-list__item-wrapper--show")})}var o=document.querySelector(".people-list__grid"),a=document.querySelector(".people-list__item"),l="https://swapi.co/api/people/",s=[];requestSWInfo(l,"GET").then(function(n){var r=n.count;e(r),t(r)},errorHandler)}(),search=function(){function e(){term=t.value;var e=new RegExp(term,"gi");peopleName.forEach(function(t){t.dataset.name.match(e)?t.parentElement.classList.add("people-list__item-wrapper--show"):t.parentElement.classList.remove("people-list__item-wrapper--show")})}var t=document.querySelector(".header__input");document.querySelectorAll(".people-list__planet");t.addEventListener("change",e),t.addEventListener("keyup",e)}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9tYWluLmpzIiwicGxhbmV0LWxpc3QuanMiLCJwZW9wbGUtbGlzdC5qcyIsInNlYXJjaC5qcyJdLCJuYW1lcyI6WyJyZXF1ZXN0U1dJbmZvIiwidXJsIiwibWV0aG9kVHlwZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwic2VuZCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJyZXNwIiwicmVzcG9uc2VUZXh0IiwicmVzcEpzb24iLCJKU09OIiwicGFyc2UiLCJlcnJvckhhbmRsZXIiLCJzdGF0dXNDb2RlIiwiY29uc29sZSIsImxvZyIsInJlZmxlY3QiLCJwcm9taXNlIiwidGhlbiIsInJlc29sdmVkIiwicmVqZWN0ZWQiLCJnZXRQbGFuZXREYXRhIiwiX3BvcHVsYXRlTGlzdCIsInBsYW5ldE51bWJlciIsImkiLCJjdXJyZW50UGxhbmV0VVJMIiwicGxhbmV0VVJMIiwicHJvbWlzZXMiLCJwdXNoIiwiYWxsIiwibWFwIiwicGxhbmV0c0RhdGEiLCJfc3RvcmVQbGFuZXREYXRhIiwiX3JlbmRlclBsYW5ldEl0ZW0iLCJfc3RhcnRBbmltYXRpb24iLCJpZCIsImZvckVhY2giLCJwbGFuZXREYXRhIiwibmV3UGxhbmV0IiwibmFtZSIsInRlcnJhaW4iLCJwb3B1bGF0aW9uIiwiZGlhbWV0ZXIiLCJyZXNpZGVudHMiLCJsZW5ndGgiLCJyZXNpZGVudFVSTCIsInJlcGxhY2UiLCJwbGFuZXREYXRhTG9jYWwiLCJwZW9wbGVEYXRhTG9jYWwiLCJwZXJzb24iLCJpbmRleCIsInBlcnNvblBsYW5ldCIsIl9nZXRQZXJzb25QbGFuZXROYW1lIiwicGxhbmV0IiwicGxhbmV0TmFtZSIsImlubmVySFRNTCIsImRhdGFzZXQiLCJwbGFuZXRJZCIsIm15UGxhbmV0IiwicGFyc2VJbnQiLCJsb2FkU2NyZWVuIiwiY2xhc3NMaXN0IiwiYWRkIiwibG9hZEdpZiIsInNldFRpbWVvdXQiLCJtYWluIiwiaXRlbVdyYXBwZXIiLCJlbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwicXVlcnlTZWxlY3RvciIsImRhdGEiLCJjb3VudCIsInJlbmRlckxpc3QiLCJfYnVpbGRMaXN0IiwicGVvcGxlTnVtYmVyIiwicGVvcGxlTGlDbG9uZSIsInBlb3BsZUxpIiwiY2xvbmVOb2RlIiwicGVvcGxlR3JpZCIsImFwcGVuZENoaWxkIiwicGVvcGxlTmFtZSIsImN1cnJlbnRQZXJzb25VUkwiLCJwZW9wbGVVUkwiLCJwZW9wbGVEYXRhIiwiX3N0b3JlUGVvcGxlRGF0YSIsIl9yZW5kZXJQZXJzb25JdGVtIiwicGVyc29uRGF0YSIsIm5ld1BlcnNvbiIsImhlaWdodCIsIndlaWdodCIsIm1hc3MiLCJiaXJ0aF95ZWFyIiwiZ2VuZGVyIiwiaG9tZXdvcmxkIiwic3BlY2llcyIsInBhcmVudEVsZW1lbnQiLCJzZWFyY2giLCJfZmlsdGVyTWF0Y2hlcyIsInRlcm0iLCJzZWFyY2hJbnB1dCIsInZhbHVlIiwicmVnZXgiLCJSZWdFeHAiLCJwZXJzb25EaXYiLCJtYXRjaCIsInJlbW92ZSIsImFkZEV2ZW50TGlzdGVuZXIiXSwibWFwcGluZ3MiOiJBQUFBLFNBQUFBLGNBQUFDLEVBQUFDLEdBb0JBLE9BbkJBLElBQUFDLFFBQUEsU0FBQUMsRUFBQUMsR0FDQSxJQUFBQyxFQUFBLElBQUFDLGVBQ0FELEVBQUFFLEtBQUFOLEVBQUFELEdBQUEsR0FDQUssRUFBQUcsT0FDQUgsRUFBQUksbUJBQUEsV0FDQSxHQUFBLElBQUFKLEVBQUFLLFdBQ0EsR0FBQSxNQUFBTCxFQUFBTSxPQUFBLENBQ0EsSUFBQUMsRUFBQVAsRUFBQVEsYUFDQUMsRUFBQUMsS0FBQUMsTUFBQUosR0FDQVQsRUFBQVcsUUFFQVYsRUFBQUMsRUFBQU0sV0FXQSxTQUFBTSxhQUFBQyxHQUNBQyxRQUFBQyxJQUFBLHFCQUFBVCxRQUdBLFNBQUFVLFFBQUFDLEdBQ0EsT0FBQUEsRUFBQUMsS0FBQSxTQUFBQyxHQUFB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Q29udGVudCI6WyJmdW5jdGlvbiByZXF1ZXN0U1dJbmZvKHVybCwgbWV0aG9kVHlwZSl7XG4gIHZhciBwcm9taXNlT2JqID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgeGhyLm9wZW4obWV0aG9kVHlwZSwgdXJsLCB0cnVlKTtcbiAgICB4aHIuc2VuZCgpO1xuICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpe1xuICAgICAgaWYoeGhyLnJlYWR5U3RhdGUgPT09IDQpe1xuICAgICAgICAgaWYoeGhyLnN0YXR1cyA9PT0gMjAwKXtcbiAgICAgICAgICB2YXIgcmVzcCA9IHhoci5yZXNwb25zZVRleHQ7XG4gICAgICAgICAgICB2YXIgcmVzcEpzb24gPSBKU09OLnBhcnNlKHJlc3ApO1xuICAgICAgICAgICAgcmVzb2x2ZShyZXNwSnNvbik7XG4gICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICByZWplY3QoeGhyLnN0YXR1cyk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInhociBmYWlsZWRcIik7IC8vIFRPRE86IGFwcGVuZCAnY2FudCBmaW5kJyBtc2dcbiAgICAgICAgICAgfVxuICAgICAgfSBlbHNle1xuICAgICAgICAgLy8gY29uc29sZS5sb2coXCJ4aHIgcHJvY2Vzc2luZyBnb2luZyBvblwiKTsgLy8gVE9ETzogYWRkIGxvYWRpbmcgYW5pbWF0aW9uXG4gICAgICAgICB9XG4gICAgfTtcbiAgfSk7XG4gIHJldHVybiBwcm9taXNlT2JqO1xufVxuXG5mdW5jdGlvbiBlcnJvckhhbmRsZXIoc3RhdHVzQ29kZSl7XG4gIGNvbnNvbGUubG9nKFwiZmFpbGVkIHdpdGggc3RhdHVzXCIsIHN0YXR1cyk7XG59XG5cbmZ1bmN0aW9uIHJlZmxlY3QocHJvbWlzZSl7XG4gIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzb2x2ZWQpeyByZXR1cm4ge3Jlc29sdmVkOnJlc29sdmVkLCBzdGF0dXM6IFwicmVzb2x2ZWRcIiB9O30sXG4gICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ocmVqZWN0ZWQpeyByZXR1cm4ge3JlamVjdGVkOnJlamVjdGVkLCBzdGF0dXM6IFwicmVqZWN0ZWRcIiB9O30pO1xufVxuXG52YXIgcGVvcGxlRGF0YUxvY2FsID0gW107XG52YXIgcGxhbmV0RGF0YUxvY2FsID0gW107XG4iLCJmdW5jdGlvbiBnZXRQbGFuZXREYXRhKCl7XG4gIHZhciBwbGFuZXROYW1lICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wZW9wbGUtbGlzdF9fcGxhbmV0Jyk7XG4gIHZhciBpdGVtV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyJyk7XG4gIHZhciBtYWluICAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYWluJyk7XG4gIHZhciBsb2FkU2NyZWVuICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5sb2FkLXNjcmVlbicpO1xuICB2YXIgbG9hZEdpZiAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubG9hZC1zY3JlZW5fX2ltZycpO1xuICB2YXIgcGxhbmV0VVJMICAgPSAnaHR0cHM6Ly9zd2FwaS5jby9hcGkvcGxhbmV0cy8nO1xuICB2YXIgcHJvbWlzZXMgICAgPSBbXTtcblxuICByZXF1ZXN0U1dJbmZvKHBsYW5ldFVSTCwgXCJHRVRcIikudGhlbihfc3RhcnRMaXN0LCBlcnJvckhhbmRsZXIpO1xuXG4gIGZ1bmN0aW9uIF9zdGFydExpc3QoZGF0YSkge1xuICAgIHZhciBwbGFuZXROdW1iZXIgPSBkYXRhLmNvdW50O1xuICAgIF9wb3B1bGF0ZUxpc3QocGxhbmV0TnVtYmVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9wb3B1bGF0ZUxpc3QocGxhbmV0TnVtYmVyKSB7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gcGxhbmV0TnVtYmVyOyBpKyspIHtcbiAgICAgIGN1cnJlbnRQbGFuZXRVUkwgPSBwbGFuZXRVUkwgKyBpO1xuICAgICAgcHJvbWlzZXMucHVzaChyZXF1ZXN0U1dJbmZvKGN1cnJlbnRQbGFuZXRVUkwsIFwiR0VUXCIpKTtcbiAgICB9XG4gICAgUHJvbWlzZS5hbGwocHJvbWlzZXMubWFwKHJlZmxlY3QpKS50aGVuKGZ1bmN0aW9uKHBsYW5ldHNEYXRhKXtcbiAgICAgIF9zdG9yZVBsYW5ldERhdGEocGxhbmV0c0RhdGEpO1xuICAgICAgX3JlbmRlclBsYW5ldEl0ZW0oKTtcbiAgICAgIF9zdGFydEFuaW1hdGlvbigpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gX3N0b3JlUGxhbmV0RGF0YShwbGFuZXRzRGF0YSkge1xuICAgIHZhciBpZCA9IDE7XG4gICAgcGxhbmV0c0RhdGEuZm9yRWFjaChmdW5jdGlvbihwbGFuZXREYXRhKSB7XG4gICAgICBpZiAocGxhbmV0RGF0YS5yZXNvbHZlZCkge1xuICAgICAgICB2YXIgbmV3UGxhbmV0ID0ge1xuICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICBuYW1lOiBwbGFuZXREYXRhLnJlc29sdmVkLm5hbWUsXG4gICAgICAgICAgdGVycmFpbjogcGxhbmV0RGF0YS5yZXNvbHZlZC50ZXJyYWluLFxuICAgICAgICAgIHBvcHVsYXRpb246IHBsYW5ldERhdGEucmVzb2x2ZWQucG9wdWxhdGlvbixcbiAgICAgICAgICBkaWFtZXRlcjogcGxhbmV0RGF0YS5yZXNvbHZlZC5kaWFtZXRlclxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChwbGFuZXREYXRhLnJlc29sdmVkLnJlc2lkZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICBuZXdQbGFuZXQucmVzaWRlbnRzID0gcGxhbmV0RGF0YS5yZXNvbHZlZC5yZXNpZGVudHMubWFwKGZ1bmN0aW9uKHJlc2lkZW50VVJMKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzaWRlbnRVUkwucmVwbGFjZSgvW14wLTldL2csJycpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld1BsYW5ldC5yZXNpZGVudHMgPSBcInVua25vd25cIjtcbiAgICAgICAgfVxuICAgICAgICBwbGFuZXREYXRhTG9jYWwucHVzaChuZXdQbGFuZXQpO1xuICAgICAgfVxuICAgICAgaWQrKztcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZW5kZXJQbGFuZXRJdGVtKCkge1xuICAgIHBlb3BsZURhdGFMb2NhbC5mb3JFYWNoKCBmdW5jdGlvbihwZXJzb24sIGluZGV4KSB7XG4gICAgICB2YXIgcGVyc29uUGxhbmV0ID0gX2dldFBlcnNvblBsYW5ldE5hbWUocGVyc29uLnBsYW5ldCk7XG4gICAgICBwbGFuZXROYW1lW2luZGV4XS5pbm5lckhUTUwgPSBwZXJzb25QbGFuZXQ7XG4gICAgICBwbGFuZXROYW1lW2luZGV4XS5kYXRhc2V0LnBsYW5ldCA9IHBlcnNvblBsYW5ldDtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9nZXRQZXJzb25QbGFuZXROYW1lKHBsYW5ldElkKSB7XG4gICAgdmFyIG15UGxhbmV0ID0gJyc7XG4gICAgcGxhbmV0RGF0YUxvY2FsLmZvckVhY2goZnVuY3Rpb24ocGxhbmV0KSB7XG4gICAgICBpZiAocGxhbmV0LmlkID09PSBwYXJzZUludChwbGFuZXRJZCkpIHtcbiAgICAgICAgbXlQbGFuZXQgPSBwbGFuZXQubmFtZTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBteVBsYW5ldDtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9zdGFydEFuaW1hdGlvbigpIHtcbiAgICBsb2FkU2NyZWVuLmNsYXNzTGlzdC5hZGQoJ2xvYWQtc2NyZWVuLS1mYWRlb3V0Jyk7XG4gICAgbG9hZEdpZi5jbGFzc0xpc3QuYWRkKCdsb2FkLXNjcmVlbl9faW1nLS1tb3Zlb3V0Jyk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIG1haW4uY2xhc3NMaXN0LmFkZCgnbWFpbi0tc2hvdycpO1xuICAgIH0sIDEwMDApO1xuICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIGl0ZW1XcmFwcGVyLmZvckVhY2goIGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyLS1zaG93LWl0ZW1zJyk7XG4gICAgICB9KTtcbiAgICB9LCAxMjAwKTtcbiAgfVxufVxuIiwidmFyIHJlbmRlckxpc3QgPSAoZnVuY3Rpb24oKSB7XG4gIHZhciBwZW9wbGVHcmlkICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBlb3BsZS1saXN0X19ncmlkJyk7XG4gIHZhciBwZW9wbGVMaSAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBlb3BsZS1saXN0X19pdGVtJyk7XG5cbiAgdmFyIHBlb3BsZVVSTCA9ICdodHRwczovL3N3YXBpLmNvL2FwaS9wZW9wbGUvJztcbiAgdmFyIHByb21pc2VzID0gW107XG5cbiAgcmVxdWVzdFNXSW5mbyhwZW9wbGVVUkwsIFwiR0VUXCIpLnRoZW4oX3N0YXJ0TGlzdCwgZXJyb3JIYW5kbGVyKTtcblxuICBmdW5jdGlvbiBfc3RhcnRMaXN0KGRhdGEpIHtcbiAgICB2YXIgcGVvcGxlTnVtYmVyID0gZGF0YS5jb3VudDtcbiAgICBfYnVpbGRMaXN0KHBlb3BsZU51bWJlcik7XG4gICAgX3BvcHVsYXRlTGlzdChwZW9wbGVOdW1iZXIpO1xuICB9XG5cbiAgZnVuY3Rpb24gX2J1aWxkTGlzdChwZW9wbGVOdW1iZXIpIHtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBlb3BsZU51bWJlcjsgaSs9Mikge1xuICAgICAgdmFyIHBlb3BsZUxpQ2xvbmUgPSBwZW9wbGVMaS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICBwZW9wbGVHcmlkLmFwcGVuZENoaWxkKHBlb3BsZUxpQ2xvbmUpO1xuICAgIH1cbiAgICBwZW9wbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBlb3BsZS1saXN0X19uYW1lJyk7XG4gIH1cblxuICBmdW5jdGlvbiBfcG9wdWxhdGVMaXN0KHBlb3BsZU51bWJlcikge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IHBlb3BsZU51bWJlcjsgaSsrKSB7XG4gICAgICBjdXJyZW50UGVyc29uVVJMID0gcGVvcGxlVVJMICsgaTtcbiAgICAgIHByb21pc2VzLnB1c2gocmVxdWVzdFNXSW5mbyhjdXJyZW50UGVyc29uVVJMLCBcIkdFVFwiKSk7XG4gICAgfVxuICAgIFByb21pc2UuYWxsKHByb21pc2VzLm1hcChyZWZsZWN0KSkudGhlbihmdW5jdGlvbihwZW9wbGVEYXRhKXtcbiAgICAgIF9zdG9yZVBlb3BsZURhdGEocGVvcGxlRGF0YSk7XG4gICAgICBfcmVuZGVyUGVyc29uSXRlbSgpO1xuICAgICAgZ2V0UGxhbmV0RGF0YSgpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gX3N0b3JlUGVvcGxlRGF0YShwZW9wbGVEYXRhKSB7XG4gICAgdmFyIGlkID0gMTtcbiAgICBwZW9wbGVEYXRhLmZvckVhY2goZnVuY3Rpb24ocGVyc29uRGF0YSkge1xuICAgICAgaWYgKHBlcnNvbkRhdGEucmVzb2x2ZWQpIHtcbiAgICAgICAgdmFyIG5ld1BlcnNvbiA9IHtcbiAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgbmFtZTogcGVyc29uRGF0YS5yZXNvbHZlZC5uYW1lLFxuICAgICAgICAgIGhlaWdodDogcGVyc29uRGF0YS5yZXNvbHZlZC5oZWlnaHQsXG4gICAgICAgICAgd2VpZ2h0OiBwZXJzb25EYXRhLnJlc29sdmVkLm1hc3MsXG4gICAgICAgICAgYmlydGhfeWVhcjogcGVyc29uRGF0YS5yZXNvbHZlZC5iaXJ0aF95ZWFyLFxuICAgICAgICAgIGdlbmRlcjogcGVyc29uRGF0YS5yZXNvbHZlZC5nZW5kZXJcbiAgICAgICAgfTtcbiAgICAgICAgcGVyc29uRGF0YS5yZXNvbHZlZC5ob21ld29ybGQgP1xuICAgICAgICBuZXdQZXJzb24ucGxhbmV0ID0gcGVyc29uRGF0YS5yZXNvbHZlZC5ob21ld29ybGQucmVwbGFjZSgvW14wLTldL2csJycpIDpcbiAgICAgICAgbmV3UGVyc29uLnBsYW5ldCA9IFwidW5rbm93blwiO1xuXG4gICAgICAgIHBlcnNvbkRhdGEucmVzb2x2ZWQuc3BlY2llc1swXSA/XG4gICAgICAgIG5ld1BlcnNvbi5zcGVjaWVzID0gcGVyc29uRGF0YS5yZXNvbHZlZC5zcGVjaWVzWzBdLnJlcGxhY2UoL1teMC05XS9nLCcnKSA6XG4gICAgICAgIG5ld1BlcnNvbi5zcGVjaWVzID0gXCJ1bmtub3duXCI7XG5cbiAgICAgICAgcGVvcGxlRGF0YUxvY2FsLnB1c2gobmV3UGVyc29uKTtcbiAgICAgIH1cbiAgICAgIGlkKys7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBfcmVuZGVyUGVyc29uSXRlbSgpIHtcbiAgICBwZW9wbGVEYXRhTG9jYWwuZm9yRWFjaCggZnVuY3Rpb24ocGVyc29uLCBpbmRleCkge1xuICAgICAgcGVvcGxlTmFtZVtpbmRleF0uZGF0YXNldC5uYW1lID0gcGVyc29uLm5hbWU7XG4gICAgICBwZW9wbGVOYW1lW2luZGV4XS5pbm5lckhUTUwgPSBwZXJzb24ubmFtZTtcbiAgICAgIHBlb3BsZU5hbWVbaW5kZXhdLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncGVvcGxlLWxpc3RfX2l0ZW0td3JhcHBlci0tc2hvdycpO1xuICAgIH0pO1xuICB9XG59KSgpO1xuIiwidmFyIHNlYXJjaCAgPSAoZnVuY3Rpb24oKSB7XG4gIHZhciBzZWFyY2hJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX2lucHV0Jyk7XG4gIHZhciBwbGFuZXROYW1lICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wZW9wbGUtbGlzdF9fcGxhbmV0Jyk7XG5cbiAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgX2ZpbHRlck1hdGNoZXMpO1xuICBzZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIF9maWx0ZXJNYXRjaGVzKTtcblxuICBmdW5jdGlvbiBfZmlsdGVyTWF0Y2hlcygpIHtcbiAgICB0ZXJtID0gc2VhcmNoSW5wdXQudmFsdWU7XG4gICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCh0ZXJtLCAnZ2knKTtcbiAgICBwZW9wbGVOYW1lLmZvckVhY2goZnVuY3Rpb24ocGVyc29uRGl2KSB7XG4gICAgICBwZXJzb25EaXYuZGF0YXNldC5uYW1lLm1hdGNoKHJlZ2V4KSA/XG4gICAgICBwZXJzb25EaXYucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwZW9wbGUtbGlzdF9faXRlbS13cmFwcGVyLS1zaG93JykgOlxuICAgICAgcGVyc29uRGl2LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncGVvcGxlLWxpc3RfX2l0ZW0td3JhcHBlci0tc2hvdycpO1xuICAgIH0pO1xuICB9XG59KSgpO1xuIl19
